<?xml version="1.0" encoding="utf-8" ?>
<UserControl x:Class="OpenEmail.Controls.ContactProfileControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:controls="using:CommunityToolkit.WinUI.Controls"
             xmlns:converters="using:OpenEmail.Converters"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:helpers="using:OpenEmail.Helpers"
             xmlns:local="using:OpenEmail.Controls"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:profile="using:OpenEmail.Domain.Models.Profile"
             xmlns:selectors="using:OpenEmail.Selectors"
             xmlns:system="using:System"
             mc:Ignorable="d">

    <UserControl.Resources>
        <DataTemplate x:Key="StringTemplate" x:DataType="profile:ProfileAttribute">
            <TextBlock TextWrapping="Wrap">
                <Run FontWeight="SemiBold" Text="{x:Bind DisplayKey}" /><Run Text=": " /><Run Text="{x:Bind Value}" />
            </TextBlock>
        </DataTemplate>

        <DataTemplate x:Key="BooleanTemplate" x:DataType="profile:ProfileAttribute">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <TextBlock VerticalAlignment="Center"
                           FontWeight="SemiBold"
                           TextTrimming="Clip">
                    <Run Text="{x:Bind DisplayKey}" /><Run Text=":" />
                </TextBlock>
                <controls:SwitchPresenter Grid.Column="1"
                                          Margin="0,0,0,2"
                                          HorizontalAlignment="Right"
                                          VerticalAlignment="Center"
                                          TargetType="x:String"
                                          Value="{x:Bind Value, Mode=OneWay}">
                    <controls:Case Value="Yes">
                        <PathIcon Data="F1 M 2.294922 10.830078 C 2.294922 10.68685 2.322591 10.551758 2.37793 10.424805 C 2.433268 10.297852 2.508138 10.187175 2.602539 10.092773 C 2.69694 9.998373 2.807617 9.923503 2.93457 9.868164 C 3.061523 9.812826 3.196615 9.785156 3.339844 9.785156 C 3.619792 9.785156 3.863932 9.889323 4.072266 10.097656 L 7.5 13.525391 L 15.927734 5.097656 C 16.136066 4.889323 16.383463 4.785156 16.669922 4.785156 C 16.81315 4.785156 16.948242 4.812826 17.075195 4.868164 C 17.202148 4.923503 17.312824 5 17.407227 5.097656 C 17.501627 5.195312 17.576496 5.307617 17.631836 5.43457 C 17.687174 5.561523 17.714844 5.693359 17.714844 5.830078 C 17.714844 6.116537 17.610676 6.363934 17.402344 6.572266 L 8.232422 15.732422 C 8.134766 15.830078 8.022461 15.906576 7.895508 15.961914 C 7.768554 16.017254 7.636718 16.044922 7.5 16.044922 C 7.220052 16.044922 6.975911 15.940756 6.767578 15.732422 L 2.597656 11.572266 C 2.395833 11.370443 2.294922 11.123047 2.294922 10.830078 Z " Foreground="LimeGreen" />
                    </controls:Case>

                    <controls:Case Value="No">
                        <PathIcon Data="F1 M 10.253906 9.375 L 16.064453 15.185547 C 16.18815 15.309245 16.25 15.455729 16.25 15.625 C 16.25 15.794271 16.18815 15.940756 16.064453 16.064453 C 15.940754 16.188152 15.79427 16.25 15.625 16.25 C 15.455729 16.25 15.309244 16.188152 15.185547 16.064453 L 9.375 10.253906 L 3.564453 16.064453 C 3.440755 16.188152 3.294271 16.25 3.125 16.25 C 2.955729 16.25 2.809245 16.188152 2.685547 16.064453 C 2.561849 15.940756 2.5 15.794271 2.5 15.625 C 2.5 15.455729 2.561849 15.309245 2.685547 15.185547 L 8.496094 9.375 L 2.685547 3.564453 C 2.561849 3.440756 2.5 3.294271 2.5 3.125 C 2.5 2.95573 2.561849 2.809246 2.685547 2.685547 C 2.809245 2.56185 2.955729 2.5 3.125 2.5 C 3.294271 2.5 3.440755 2.56185 3.564453 2.685547 L 9.375 8.496094 L 15.185547 2.685547 C 15.309244 2.56185 15.455729 2.5 15.625 2.5 C 15.79427 2.5 15.940754 2.56185 16.064453 2.685547 C 16.18815 2.809246 16.25 2.95573 16.25 3.125 C 16.25 3.294271 16.18815 3.440756 16.064453 3.564453 Z " Foreground="Red" />
                    </controls:Case>

                    <controls:Case Value="True">
                        <PathIcon Data="F1 M 2.294922 10.830078 C 2.294922 10.68685 2.322591 10.551758 2.37793 10.424805 C 2.433268 10.297852 2.508138 10.187175 2.602539 10.092773 C 2.69694 9.998373 2.807617 9.923503 2.93457 9.868164 C 3.061523 9.812826 3.196615 9.785156 3.339844 9.785156 C 3.619792 9.785156 3.863932 9.889323 4.072266 10.097656 L 7.5 13.525391 L 15.927734 5.097656 C 16.136066 4.889323 16.383463 4.785156 16.669922 4.785156 C 16.81315 4.785156 16.948242 4.812826 17.075195 4.868164 C 17.202148 4.923503 17.312824 5 17.407227 5.097656 C 17.501627 5.195312 17.576496 5.307617 17.631836 5.43457 C 17.687174 5.561523 17.714844 5.693359 17.714844 5.830078 C 17.714844 6.116537 17.610676 6.363934 17.402344 6.572266 L 8.232422 15.732422 C 8.134766 15.830078 8.022461 15.906576 7.895508 15.961914 C 7.768554 16.017254 7.636718 16.044922 7.5 16.044922 C 7.220052 16.044922 6.975911 15.940756 6.767578 15.732422 L 2.597656 11.572266 C 2.395833 11.370443 2.294922 11.123047 2.294922 10.830078 Z " Foreground="LimeGreen" />
                    </controls:Case>

                    <controls:Case Value="False">
                        <PathIcon Data="F1 M 10.253906 9.375 L 16.064453 15.185547 C 16.18815 15.309245 16.25 15.455729 16.25 15.625 C 16.25 15.794271 16.18815 15.940756 16.064453 16.064453 C 15.940754 16.188152 15.79427 16.25 15.625 16.25 C 15.455729 16.25 15.309244 16.188152 15.185547 16.064453 L 9.375 10.253906 L 3.564453 16.064453 C 3.440755 16.188152 3.294271 16.25 3.125 16.25 C 2.955729 16.25 2.809245 16.188152 2.685547 16.064453 C 2.561849 15.940756 2.5 15.794271 2.5 15.625 C 2.5 15.455729 2.561849 15.309245 2.685547 15.185547 L 8.496094 9.375 L 2.685547 3.564453 C 2.561849 3.440756 2.5 3.294271 2.5 3.125 C 2.5 2.95573 2.561849 2.809246 2.685547 2.685547 C 2.809245 2.56185 2.955729 2.5 3.125 2.5 C 3.294271 2.5 3.440755 2.56185 3.564453 2.685547 L 9.375 8.496094 L 15.185547 2.685547 C 15.309244 2.56185 15.455729 2.5 15.625 2.5 C 15.79427 2.5 15.940754 2.56185 16.064453 2.685547 C 16.18815 2.809246 16.25 2.95573 16.25 3.125 C 16.25 3.294271 16.18815 3.440756 16.064453 3.564453 Z " Foreground="Red" />
                    </controls:Case>

                    <controls:Case Value="">
                        <PathIcon Data="F1 M 10.253906 9.375 L 16.064453 15.185547 C 16.18815 15.309245 16.25 15.455729 16.25 15.625 C 16.25 15.794271 16.18815 15.940756 16.064453 16.064453 C 15.940754 16.188152 15.79427 16.25 15.625 16.25 C 15.455729 16.25 15.309244 16.188152 15.185547 16.064453 L 9.375 10.253906 L 3.564453 16.064453 C 3.440755 16.188152 3.294271 16.25 3.125 16.25 C 2.955729 16.25 2.809245 16.188152 2.685547 16.064453 C 2.561849 15.940756 2.5 15.794271 2.5 15.625 C 2.5 15.455729 2.561849 15.309245 2.685547 15.185547 L 8.496094 9.375 L 2.685547 3.564453 C 2.561849 3.440756 2.5 3.294271 2.5 3.125 C 2.5 2.95573 2.561849 2.809246 2.685547 2.685547 C 2.809245 2.56185 2.955729 2.5 3.125 2.5 C 3.294271 2.5 3.440755 2.56185 3.564453 2.685547 L 9.375 8.496094 L 15.185547 2.685547 C 15.309244 2.56185 15.455729 2.5 15.625 2.5 C 15.79427 2.5 15.940754 2.56185 16.064453 2.685547 C 16.18815 2.809246 16.25 2.95573 16.25 3.125 C 16.25 3.294271 16.18815 3.440756 16.064453 3.564453 Z " Foreground="Red" />
                    </controls:Case>
                </controls:SwitchPresenter>
            </Grid>
        </DataTemplate>

        <DataTemplate x:Key="DateTimeTemplate" x:DataType="profile:ProfileAttribute">
            <TextBlock TextWrapping="Wrap">
                <Run FontWeight="SemiBold" Text="{x:Bind DisplayKey}" /><Run Text=": " /><Run Text="{x:Bind helpers:XamlHelpers.GetTimeAgo(Value)}" />
            </TextBlock>
        </DataTemplate>

        <DataTemplate x:Key="DateTimeOffsetTemplate" x:DataType="profile:ProfileAttribute">
            <TextBlock TextWrapping="Wrap">
                <Run FontWeight="SemiBold" Text="{x:Bind DisplayKey}" /><Run Text=": " /><Run Text="{x:Bind helpers:XamlHelpers.GetTimeAgo(Value)}" />
            </TextBlock>
        </DataTemplate>

        <selectors:ProfilePropertyTemplateSelector x:Key="ProfilePropertyTemplateSelector"
                                                   BooleanTemplate="{StaticResource BooleanTemplate}"
                                                   DateTimeOffsetTemplate="{StaticResource DateTimeOffsetTemplate}"
                                                   DateTimeTemplate="{StaticResource DateTimeTemplate}"
                                                   StringTemplate="{StaticResource StringTemplate}" />

        <converters:ProfileImageConverter x:Key="ProfileImageConverter" UseEmptyAvatarIfNoImage="True" />
    </UserControl.Resources>

    <Grid Padding="24,12" ColumnSpacing="24">
        <ScrollViewer x:Name="LoadedGrid" VerticalScrollBarVisibility="Hidden">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <Grid MaxWidth="200"
                      VerticalAlignment="Top"
                      CornerRadius="8">
                    <Image Source="{x:Bind Contact.ProfileImageUrl, Converter={StaticResource ProfileImageConverter}, Mode=OneWay}" />
                </Grid>

                <Grid Grid.Row="1"
                      Margin="0,12"
                      RowSpacing="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <TextBlock FontWeight="SemiBold" Text="{x:Bind Contact.Profile.Name, Mode=OneWay}" />
                    <TextBlock Grid.Row="1" Text="{x:Bind Contact.Contact.Address, Mode=OneWay}" />
                    <Rectangle Grid.Row="2"
                               Height="1"
                               HorizontalAlignment="Stretch"
                               Fill="Gray"
                               Visibility="{x:Bind BroadcastPanel.Visibility, Mode=OneWay}" />

                    <!--  Broadcast  -->
                    <Grid x:Name="BroadcastPanel"
                          Grid.Row="3"
                          Visibility="{x:Bind Contact.Contact.IsRequestAcccepted, Mode=OneWay}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <StackPanel VerticalAlignment="Center"
                                    Orientation="Horizontal"
                                    Spacing="6">
                            <PathIcon Data="F1 M 0 10 C 0 9.329428 0.063477 8.671875 0.19043 8.027344 C 0.317383 7.382812 0.511068 6.751303 0.771484 6.132812 C 0.888672 5.859375 1.025391 5.576172 1.181641 5.283203 C 1.337891 4.990234 1.508789 4.702148 1.694336 4.418945 C 1.879883 4.135742 2.076823 3.865561 2.285156 3.608398 C 2.49349 3.351238 2.711588 3.121746 2.939453 2.919922 C 3.004557 2.861328 3.066406 2.817383 3.125 2.788086 C 3.183594 2.758789 3.258463 2.744141 3.349609 2.744141 C 3.525391 2.744141 3.671875 2.809246 3.789062 2.939453 C 3.90625 3.069662 3.964844 3.219402 3.964844 3.388672 C 3.964844 3.49284 3.948568 3.579102 3.916016 3.647461 C 3.883463 3.71582 3.834635 3.785809 3.769531 3.857422 C 3.619792 4.026693 3.473307 4.189453 3.330078 4.345703 C 3.186849 4.501953 3.05013 4.671225 2.919922 4.853516 C 2.373047 5.602214 1.958008 6.414389 1.674805 7.290039 C 1.391602 8.16569 1.25 9.069011 1.25 10 C 1.25 10.598959 1.308594 11.189779 1.425781 11.772461 C 1.542969 12.355144 1.722005 12.923178 1.962891 13.476562 C 2.333984 14.342448 2.835286 15.123698 3.466797 15.820312 C 3.544922 15.911459 3.626302 15.996094 3.710938 16.074219 C 3.795573 16.152344 3.876953 16.23698 3.955078 16.328125 C 4.026692 16.40625 4.080403 16.481119 4.116211 16.552734 C 4.152018 16.62435 4.169922 16.715496 4.169922 16.826172 C 4.169922 17.001953 4.108073 17.148438 3.984375 17.265625 C 3.860677 17.382812 3.714193 17.441406 3.544922 17.441406 C 3.401693 17.441406 3.271484 17.392578 3.154297 17.294922 C 2.926432 17.112631 2.700195 16.888021 2.475586 16.621094 C 2.250977 16.354168 2.036133 16.072592 1.831055 15.776367 C 1.625976 15.480144 1.437174 15.179037 1.264648 14.873047 C 1.092122 14.567058 0.947266 14.2806 0.830078 14.013672 C 0.55013 13.375651 0.341797 12.721354 0.205078 12.050781 C 0.068359 11.380209 0 10.696615 0 10 Z M 16.455078 17.441406 C 16.285807 17.441406 16.139322 17.382812 16.015625 17.265625 C 15.891927 17.148438 15.830078 17.001953 15.830078 16.826172 C 15.830078 16.715496 15.847981 16.62435 15.883789 16.552734 C 15.919596 16.481119 15.973307 16.40625 16.044922 16.328125 C 16.123047 16.23698 16.204426 16.152344 16.289062 16.074219 C 16.373697 15.996094 16.455078 15.911459 16.533203 15.820312 C 17.164713 15.123698 17.666016 14.342448 18.037109 13.476562 C 18.277994 12.923178 18.457031 12.355144 18.574219 11.772461 C 18.691406 11.189779 18.75 10.598959 18.75 10 C 18.75 9.069011 18.608398 8.16569 18.325195 7.290039 C 18.041992 6.414389 17.626953 5.602214 17.080078 4.853516 C 16.949869 4.671225 16.81315 4.501953 16.669922 4.345703 C 16.526691 4.189453 16.380207 4.026693 16.230469 3.857422 C 16.165363 3.785809 16.116535 3.71582 16.083984 3.647461 C 16.051432 3.579102 16.035156 3.49284 16.035156 3.388672 C 16.035156 3.219402 16.09375 3.069662 16.210938 2.939453 C 16.328125 2.809246 16.474609 2.744141 16.650391 2.744141 C 16.741535 2.744141 16.816406 2.758789 16.875 2.788086 C 16.933594 2.817383 16.995441 2.861328 17.060547 2.919922 C 17.2819 3.115234 17.498371 3.341473 17.709961 3.598633 C 17.921549 3.855795 18.118488 4.125977 18.300781 4.40918 C 18.483072 4.692383 18.652344 4.982097 18.808594 5.27832 C 18.964844 5.574545 19.101562 5.859375 19.21875 6.132812 C 19.479166 6.744793 19.674479 7.374676 19.804688 8.022461 C 19.934895 8.670248 20 9.329428 20 10 C 20 11.39974 19.720051 12.737631 19.160156 14.013672 C 19.042969 14.2806 18.899738 14.567058 18.730469 14.873047 C 18.561197 15.179037 18.374023 15.480144 18.168945 15.776367 C 17.963867 16.072592 17.749023 16.354168 17.524414 16.621094 C 17.299805 16.888021 17.073566 17.112631 16.845703 17.294922 C 16.728516 17.392578 16.598307 17.441406 16.455078 17.441406 Z M 3.125 10 C 3.125 9.563803 3.170573 9.119467 3.261719 8.666992 C 3.352864 8.21452 3.4847 7.775066 3.657227 7.348633 C 3.829752 6.922201 4.042969 6.516928 4.296875 6.132812 C 4.550781 5.748699 4.840495 5.410157 5.166016 5.117188 C 5.224609 5.065104 5.283203 5.024414 5.341797 4.995117 C 5.400391 4.96582 5.472005 4.951172 5.556641 4.951172 C 5.725911 4.951172 5.870768 5.014648 5.991211 5.141602 C 6.111653 5.268555 6.171875 5.416667 6.171875 5.585938 C 6.171875 5.690104 6.153971 5.779623 6.118164 5.854492 C 6.082356 5.929363 6.0319 6.00586 5.966797 6.083984 C 5.712891 6.383464 5.486653 6.679688 5.288086 6.972656 C 5.089518 7.265625 4.921875 7.569987 4.785156 7.885742 C 4.648438 8.201498 4.545898 8.531901 4.477539 8.876953 C 4.40918 9.222006 4.375 9.596354 4.375 10 C 4.375 10.625 4.475911 11.232097 4.677734 11.821289 C 4.879557 12.410482 5.172526 12.949219 5.556641 13.4375 C 5.647786 13.554688 5.742188 13.665365 5.839844 13.769531 C 5.9375 13.873698 6.038411 13.98112 6.142578 14.091797 C 6.214192 14.169922 6.269531 14.249675 6.308594 14.331055 C 6.347656 14.412436 6.367188 14.508464 6.367188 14.619141 C 6.367188 14.788412 6.308594 14.934896 6.191406 15.058594 C 6.074219 15.182292 5.930989 15.244141 5.761719 15.244141 C 5.63151 15.244141 5.507812 15.195312 5.390625 15.097656 C 5.032552 14.798178 4.713542 14.44987 4.433594 14.052734 C 4.153646 13.6556 3.916015 13.23405 3.720703 12.788086 C 3.52539 12.342123 3.377278 11.881511 3.276367 11.40625 C 3.175456 10.93099 3.125 10.46224 3.125 10 Z M 14.238281 15.244141 C 14.06901 15.244141 13.925781 15.182292 13.808594 15.058594 C 13.691406 14.934896 13.632812 14.788412 13.632812 14.619141 C 13.632812 14.508464 13.652344 14.412436 13.691406 14.331055 C 13.730469 14.249675 13.785807 14.169922 13.857422 14.091797 C 13.961588 13.98112 14.0625 13.873698 14.160156 13.769531 C 14.257812 13.665365 14.352213 13.554688 14.443359 13.4375 C 14.827474 12.949219 15.120442 12.410482 15.322266 11.821289 C 15.524088 11.232097 15.625 10.625 15.625 10 C 15.625 9.596354 15.59082 9.222006 15.522461 8.876953 C 15.454102 8.531901 15.351562 8.201498 15.214844 7.885742 C 15.078125 7.569987 14.910481 7.265625 14.711914 6.972656 C 14.513346 6.679688 14.287108 6.383464 14.033203 6.083984 C 13.968099 6.00586 13.917643 5.929363 13.881836 5.854492 C 13.846027 5.779623 13.828124 5.690104 13.828125 5.585938 C 13.828124 5.416667 13.888346 5.268555 14.008789 5.141602 C 14.129231 5.014648 14.274088 4.951172 14.443359 4.951172 C 14.527994 4.951172 14.599609 4.96582 14.658203 4.995117 C 14.716797 5.024414 14.775391 5.065104 14.833984 5.117188 C 15.159504 5.410157 15.449218 5.748699 15.703125 6.132812 C 15.95703 6.516928 16.170246 6.922201 16.342773 7.348633 C 16.515299 7.775066 16.647135 8.21452 16.738281 8.666992 C 16.829426 9.119467 16.875 9.563803 16.875 10 C 16.875 10.46224 16.824543 10.93099 16.723633 11.40625 C 16.622721 11.881511 16.474609 12.342123 16.279297 12.788086 C 16.083984 13.23405 15.846354 13.6556 15.566406 14.052734 C 15.286457 14.44987 14.967447 14.798178 14.609375 15.097656 C 14.550781 15.14974 14.493814 15.187175 14.438477 15.209961 C 14.383137 15.232748 14.316405 15.244141 14.238281 15.244141 Z M 8.4375 10 C 8.4375 9.785156 8.479817 9.583334 8.564453 9.394531 C 8.649088 9.205729 8.761393 9.041342 8.901367 8.901367 C 9.041341 8.761394 9.205729 8.649089 9.394531 8.564453 C 9.583333 8.479818 9.785156 8.4375 10 8.4375 C 10.214844 8.4375 10.416666 8.479818 10.605469 8.564453 C 10.794271 8.649089 10.958658 8.761394 11.098633 8.901367 C 11.238606 9.041342 11.350911 9.205729 11.435547 9.394531 C 11.520182 9.583334 11.5625 9.785156 11.5625 10 C 11.5625 10.214844 11.520182 10.416667 11.435547 10.605469 C 11.350911 10.794271 11.238606 10.958659 11.098633 11.098633 C 10.958658 11.238607 10.794271 11.350912 10.605469 11.435547 C 10.416666 11.520183 10.214844 11.5625 10 11.5625 C 9.785156 11.5625 9.583333 11.520183 9.394531 11.435547 C 9.205729 11.350912 9.041341 11.238607 8.901367 11.098633 C 8.761393 10.958659 8.649088 10.794271 8.564453 10.605469 C 8.479817 10.416667 8.4375 10.214844 8.4375 10 Z " />
                            <TextBlock Text="Broadcast" />
                        </StackPanel>

                        <ToggleSwitch Grid.Column="1"
                                      HorizontalAlignment="Right"
                                      HorizontalContentAlignment="Right"
                                      FlowDirection="RightToLeft"
                                      IsOn="{x:Bind IsBroadcastOn, Mode=TwoWay}"
                                      OffContent="Off"
                                      OnContent="On" />
                    </Grid>

                    <Rectangle Grid.Row="4"
                               Height="1"
                               HorizontalAlignment="Stretch"
                               Fill="Gray"
                               Visibility="{x:Bind BroadcastPanel.Visibility, Mode=OneWay}" />

                    <TextBlock Grid.Row="5"
                               FontSize="15"
                               FontWeight="Bold"
                               Text="Configuration" />

                    <ItemsControl Grid.Row="6"
                                  ItemTemplateSelector="{StaticResource ProfilePropertyTemplateSelector}"
                                  ItemsSource="{x:Bind Contact.Profile.DisplayAttributes, Mode=OneWay}">
                        <!--<ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <ItemsWrapGrid MaximumRowsOrColumns="2" Orientation="Horizontal"  />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>-->
                    </ItemsControl>
                </Grid>
            </Grid>
        </ScrollViewer>

        <Grid x:Name="ProfileLoadingGrid"
              HorizontalAlignment="Center"
              VerticalAlignment="Center"
              Visibility="Collapsed">
            <StackPanel>
                <TextBlock Text="Loading profile..." />
                <ProgressRing />
            </StackPanel>
        </Grid>

        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="ProfileLoadingStates">
                <VisualState x:Name="ProfileLoaded" />
                <VisualState x:Name="ProfileLoading">
                    <VisualState.Setters>
                        <Setter Target="LoadedGrid.Visibility" Value="Collapsed" />
                        <Setter Target="ProfileLoadingGrid.Visibility" Value="Visible" />
                    </VisualState.Setters>
                    <VisualState.StateTriggers>
                        <StateTrigger IsActive="{x:Bind IsLoadingProfile, Mode=OneWay}" />
                    </VisualState.StateTriggers>
                </VisualState>

            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
    </Grid>
</UserControl>

