<?xml version="1.0" encoding="utf-8" ?>
<local:MailListPageAbstract
    x:Class="OpenEmail.Views.MailListPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Interactivity="using:Microsoft.Xaml.Interactivity"
    xmlns:behaviors="using:OpenEmail.Behaviors"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:controls1="using:OpenEmail.Controls"
    xmlns:converters="using:OpenEmail.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:data="using:OpenEmail.ViewModels.Data"
    xmlns:helpers="using:OpenEmail.Helpers"
    xmlns:local="using:OpenEmail.Views"
    xmlns:main="using:OpenEmail"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    x:Name="root"
    mc:Ignorable="d">

    <Page.Resources>
        <Style x:Key="MailActionButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{ThemeResource ApplicationPageBackgroundThemeBrush}" />
            <Setter Property="CornerRadius" Value="4" />
            <Setter Property="BorderBrush" Value="{ThemeResource DetailForegroundBrush}" />
            <Setter Property="BorderThickness" Value="1.5" />
        </Style>

        <DataTemplate x:Key="MessageTemplate" x:DataType="data:MessageViewModel">
            <Grid
                MaxHeight="80"
                Padding="0,10"
                ColumnSpacing="6">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="48" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!--  Avatar  -->
                <PersonPicture
                    Width="44"
                    DisplayName="{x:Bind ContactViewModel.ContactDisplayName, Mode=OneWay}"
                    ProfilePicture="{x:Bind ContactViewModel.ProfileThumbnailUrl, Converter={StaticResource ProfileImageConverter}, Mode=OneWay}" />

                <!--  Unrad badge  -->
                <InfoBadge
                    Width="14"
                    Height="14"
                    Margin="4,4,0,48"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    Visibility="{x:Bind helpers:XamlHelpers.ReverseBooleanToVisibility(IsRead), Mode=OneWay}" />

                <!--  Details  -->
                <Grid Grid.Column="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <!--  Name & Date  -->
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            FontWeight="{x:Bind helpers:XamlHelpers.IsReadConverter(Message.IsRead), Mode=OneWay}"
                            Text="{x:Bind ContactViewModel.ContactDisplayName}"
                            TextTrimming="CharacterEllipsis" />

                        <TextBlock
                            Grid.Column="1"
                            Margin="12,0,0,0"
                            VerticalAlignment="Center"
                            FontSize="12"
                            Foreground="{ThemeResource DetailForegroundBrush}"
                            Text="{x:Bind helpers:XamlHelpers.GetDisplayDateOnListingPage(Message.CreatedAt), Mode=OneWay}" />
                    </Grid>

                    <!--  Subject  -->
                    <TextBlock
                        Grid.Row="1"
                        FontWeight="{x:Bind helpers:XamlHelpers.IsReadConverter(Message.IsRead), Mode=OneWay}"
                        Text="{x:Bind helpers:XamlHelpers.EmptyTextConverter(Subject,'(no subject)'), Mode=OneWay}"
                        TextTrimming="CharacterEllipsis" />

                    <!--  Message  -->
                    <Grid Grid.Row="2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            Grid.Row="2"
                            MaxLines="1"
                            Text="{x:Bind helpers:XamlHelpers.EmptyTextConverter(Body,'(no message)'), Mode=OneWay}"
                            TextTrimming="CharacterEllipsis"
                            TextWrapping="Wrap" />

                        <PathIcon
                            Grid.Column="1"
                            Data="F1 M 0 10 C 0 9.329428 0.063477 8.671875 0.19043 8.027344 C 0.317383 7.382812 0.511068 6.751303 0.771484 6.132812 C 0.888672 5.859375 1.025391 5.576172 1.181641 5.283203 C 1.337891 4.990234 1.508789 4.702148 1.694336 4.418945 C 1.879883 4.135742 2.076823 3.865561 2.285156 3.608398 C 2.49349 3.351238 2.711588 3.121746 2.939453 2.919922 C 3.004557 2.861328 3.066406 2.817383 3.125 2.788086 C 3.183594 2.758789 3.258463 2.744141 3.349609 2.744141 C 3.525391 2.744141 3.671875 2.809246 3.789062 2.939453 C 3.90625 3.069662 3.964844 3.219402 3.964844 3.388672 C 3.964844 3.49284 3.948568 3.579102 3.916016 3.647461 C 3.883463 3.71582 3.834635 3.785809 3.769531 3.857422 C 3.619792 4.026693 3.473307 4.189453 3.330078 4.345703 C 3.186849 4.501953 3.05013 4.671225 2.919922 4.853516 C 2.373047 5.602214 1.958008 6.414389 1.674805 7.290039 C 1.391602 8.16569 1.25 9.069011 1.25 10 C 1.25 10.598959 1.308594 11.189779 1.425781 11.772461 C 1.542969 12.355144 1.722005 12.923178 1.962891 13.476562 C 2.333984 14.342448 2.835286 15.123698 3.466797 15.820312 C 3.544922 15.911459 3.626302 15.996094 3.710938 16.074219 C 3.795573 16.152344 3.876953 16.23698 3.955078 16.328125 C 4.026692 16.40625 4.080403 16.481119 4.116211 16.552734 C 4.152018 16.62435 4.169922 16.715496 4.169922 16.826172 C 4.169922 17.001953 4.108073 17.148438 3.984375 17.265625 C 3.860677 17.382812 3.714193 17.441406 3.544922 17.441406 C 3.401693 17.441406 3.271484 17.392578 3.154297 17.294922 C 2.926432 17.112631 2.700195 16.888021 2.475586 16.621094 C 2.250977 16.354168 2.036133 16.072592 1.831055 15.776367 C 1.625976 15.480144 1.437174 15.179037 1.264648 14.873047 C 1.092122 14.567058 0.947266 14.2806 0.830078 14.013672 C 0.55013 13.375651 0.341797 12.721354 0.205078 12.050781 C 0.068359 11.380209 0 10.696615 0 10 Z M 16.455078 17.441406 C 16.285807 17.441406 16.139322 17.382812 16.015625 17.265625 C 15.891927 17.148438 15.830078 17.001953 15.830078 16.826172 C 15.830078 16.715496 15.847981 16.62435 15.883789 16.552734 C 15.919596 16.481119 15.973307 16.40625 16.044922 16.328125 C 16.123047 16.23698 16.204426 16.152344 16.289062 16.074219 C 16.373697 15.996094 16.455078 15.911459 16.533203 15.820312 C 17.164713 15.123698 17.666016 14.342448 18.037109 13.476562 C 18.277994 12.923178 18.457031 12.355144 18.574219 11.772461 C 18.691406 11.189779 18.75 10.598959 18.75 10 C 18.75 9.069011 18.608398 8.16569 18.325195 7.290039 C 18.041992 6.414389 17.626953 5.602214 17.080078 4.853516 C 16.949869 4.671225 16.81315 4.501953 16.669922 4.345703 C 16.526691 4.189453 16.380207 4.026693 16.230469 3.857422 C 16.165363 3.785809 16.116535 3.71582 16.083984 3.647461 C 16.051432 3.579102 16.035156 3.49284 16.035156 3.388672 C 16.035156 3.219402 16.09375 3.069662 16.210938 2.939453 C 16.328125 2.809246 16.474609 2.744141 16.650391 2.744141 C 16.741535 2.744141 16.816406 2.758789 16.875 2.788086 C 16.933594 2.817383 16.995441 2.861328 17.060547 2.919922 C 17.2819 3.115234 17.498371 3.341473 17.709961 3.598633 C 17.921549 3.855795 18.118488 4.125977 18.300781 4.40918 C 18.483072 4.692383 18.652344 4.982097 18.808594 5.27832 C 18.964844 5.574545 19.101562 5.859375 19.21875 6.132812 C 19.479166 6.744793 19.674479 7.374676 19.804688 8.022461 C 19.934895 8.670248 20 9.329428 20 10 C 20 11.39974 19.720051 12.737631 19.160156 14.013672 C 19.042969 14.2806 18.899738 14.567058 18.730469 14.873047 C 18.561197 15.179037 18.374023 15.480144 18.168945 15.776367 C 17.963867 16.072592 17.749023 16.354168 17.524414 16.621094 C 17.299805 16.888021 17.073566 17.112631 16.845703 17.294922 C 16.728516 17.392578 16.598307 17.441406 16.455078 17.441406 Z M 3.125 10 C 3.125 9.563803 3.170573 9.119467 3.261719 8.666992 C 3.352864 8.21452 3.4847 7.775066 3.657227 7.348633 C 3.829752 6.922201 4.042969 6.516928 4.296875 6.132812 C 4.550781 5.748699 4.840495 5.410157 5.166016 5.117188 C 5.224609 5.065104 5.283203 5.024414 5.341797 4.995117 C 5.400391 4.96582 5.472005 4.951172 5.556641 4.951172 C 5.725911 4.951172 5.870768 5.014648 5.991211 5.141602 C 6.111653 5.268555 6.171875 5.416667 6.171875 5.585938 C 6.171875 5.690104 6.153971 5.779623 6.118164 5.854492 C 6.082356 5.929363 6.0319 6.00586 5.966797 6.083984 C 5.712891 6.383464 5.486653 6.679688 5.288086 6.972656 C 5.089518 7.265625 4.921875 7.569987 4.785156 7.885742 C 4.648438 8.201498 4.545898 8.531901 4.477539 8.876953 C 4.40918 9.222006 4.375 9.596354 4.375 10 C 4.375 10.625 4.475911 11.232097 4.677734 11.821289 C 4.879557 12.410482 5.172526 12.949219 5.556641 13.4375 C 5.647786 13.554688 5.742188 13.665365 5.839844 13.769531 C 5.9375 13.873698 6.038411 13.98112 6.142578 14.091797 C 6.214192 14.169922 6.269531 14.249675 6.308594 14.331055 C 6.347656 14.412436 6.367188 14.508464 6.367188 14.619141 C 6.367188 14.788412 6.308594 14.934896 6.191406 15.058594 C 6.074219 15.182292 5.930989 15.244141 5.761719 15.244141 C 5.63151 15.244141 5.507812 15.195312 5.390625 15.097656 C 5.032552 14.798178 4.713542 14.44987 4.433594 14.052734 C 4.153646 13.6556 3.916015 13.23405 3.720703 12.788086 C 3.52539 12.342123 3.377278 11.881511 3.276367 11.40625 C 3.175456 10.93099 3.125 10.46224 3.125 10 Z M 14.238281 15.244141 C 14.06901 15.244141 13.925781 15.182292 13.808594 15.058594 C 13.691406 14.934896 13.632812 14.788412 13.632812 14.619141 C 13.632812 14.508464 13.652344 14.412436 13.691406 14.331055 C 13.730469 14.249675 13.785807 14.169922 13.857422 14.091797 C 13.961588 13.98112 14.0625 13.873698 14.160156 13.769531 C 14.257812 13.665365 14.352213 13.554688 14.443359 13.4375 C 14.827474 12.949219 15.120442 12.410482 15.322266 11.821289 C 15.524088 11.232097 15.625 10.625 15.625 10 C 15.625 9.596354 15.59082 9.222006 15.522461 8.876953 C 15.454102 8.531901 15.351562 8.201498 15.214844 7.885742 C 15.078125 7.569987 14.910481 7.265625 14.711914 6.972656 C 14.513346 6.679688 14.287108 6.383464 14.033203 6.083984 C 13.968099 6.00586 13.917643 5.929363 13.881836 5.854492 C 13.846027 5.779623 13.828124 5.690104 13.828125 5.585938 C 13.828124 5.416667 13.888346 5.268555 14.008789 5.141602 C 14.129231 5.014648 14.274088 4.951172 14.443359 4.951172 C 14.527994 4.951172 14.599609 4.96582 14.658203 4.995117 C 14.716797 5.024414 14.775391 5.065104 14.833984 5.117188 C 15.159504 5.410157 15.449218 5.748699 15.703125 6.132812 C 15.95703 6.516928 16.170246 6.922201 16.342773 7.348633 C 16.515299 7.775066 16.647135 8.21452 16.738281 8.666992 C 16.829426 9.119467 16.875 9.563803 16.875 10 C 16.875 10.46224 16.824543 10.93099 16.723633 11.40625 C 16.622721 11.881511 16.474609 12.342123 16.279297 12.788086 C 16.083984 13.23405 15.846354 13.6556 15.566406 14.052734 C 15.286457 14.44987 14.967447 14.798178 14.609375 15.097656 C 14.550781 15.14974 14.493814 15.187175 14.438477 15.209961 C 14.383137 15.232748 14.316405 15.244141 14.238281 15.244141 Z M 8.4375 10 C 8.4375 9.785156 8.479817 9.583334 8.564453 9.394531 C 8.649088 9.205729 8.761393 9.041342 8.901367 8.901367 C 9.041341 8.761394 9.205729 8.649089 9.394531 8.564453 C 9.583333 8.479818 9.785156 8.4375 10 8.4375 C 10.214844 8.4375 10.416666 8.479818 10.605469 8.564453 C 10.794271 8.649089 10.958658 8.761394 11.098633 8.901367 C 11.238606 9.041342 11.350911 9.205729 11.435547 9.394531 C 11.520182 9.583334 11.5625 9.785156 11.5625 10 C 11.5625 10.214844 11.520182 10.416667 11.435547 10.605469 C 11.350911 10.794271 11.238606 10.958659 11.098633 11.098633 C 10.958658 11.238607 10.794271 11.350912 10.605469 11.435547 C 10.416666 11.520183 10.214844 11.5625 10 11.5625 C 9.785156 11.5625 9.583333 11.520183 9.394531 11.435547 C 9.205729 11.350912 9.041341 11.238607 8.901367 11.098633 C 8.761393 10.958659 8.649088 10.794271 8.564453 10.605469 C 8.479817 10.416667 8.4375 10.214844 8.4375 10 Z "
                            Foreground="{ThemeResource BroadcastTagForegroundBrush}"
                            Visibility="{x:Bind IsBroadcast, Mode=OneWay}" />
                    </Grid>
                </Grid>
            </Grid>
        </DataTemplate>

        <DataTemplate x:Key="ReaderTemplate" x:DataType="data:ContactViewModel">
            <Button
                Margin="4,0"
                Padding="8,4"
                BorderBrush="{ThemeResource GeneralSeperatorBrush}"
                Command="{x:Bind RaiseDisplayContactCommand}"
                Content="{x:Bind ContactDisplayName, Mode=OneWay}"
                CornerRadius="2" />
        </DataTemplate>

        <converters:GridLengthConverter x:Key="GridLengthConverter" />
    </Page.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition
                Width="{x:Bind ViewModel.PreferencesService.MessageListingPaneWidth, Converter={StaticResource GridLengthConverter}}"
                MinWidth="250"
                MaxWidth="600" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>


        <!--  Left Content  -->
        <ListView
            Grid.Row="1"
            Padding="8,0"
            ItemTemplate="{StaticResource MessageTemplate}"
            ItemsSource="{x:Bind ViewModel.Messages}"
            SelectionMode="Extended">
            <ListView.Header>
                <Grid Padding="12" RowSpacing="12">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <!--  Title + Add  -->
                    <TextBlock
                        FontSize="20"
                        FontWeight="SemiBold"
                        Text="{x:Bind helpers:XamlHelpers.GetFolderHeaderTitle(ViewModel.CurrentMailFolderType), Mode=OneWay}" />

                    <AutoSuggestBox Grid.Row="1" Style="{StaticResource OpenEmailAutoSuggestBoxStyle}" />

                    <!--  No messages area  -->
                    <Grid
                        Grid.Row="2"
                        Padding="12"
                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        CornerRadius="6"
                        Visibility="{x:Bind ViewModel.HasNoMessages, Mode=OneWay}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Viewbox Width="24">
                            <PathIcon Data="F1 M 3.056641 18.75 C 2.646484 18.75 2.255859 18.666992 1.884766 18.500977 C 1.513672 18.334961 1.189779 18.113607 0.913086 17.836914 C 0.636393 17.560221 0.415039 17.236328 0.249023 16.865234 C 0.083008 16.494141 0 16.103516 0 15.693359 L 0 4.306641 C 0 3.896484 0.083008 3.505859 0.249023 3.134766 C 0.415039 2.763672 0.636393 2.439779 0.913086 2.163086 C 1.189779 1.886395 1.513672 1.665039 1.884766 1.499023 C 2.255859 1.333008 2.646484 1.25 3.056641 1.25 L 6.875 1.25 C 7.376302 1.25 7.843424 1.359051 8.276367 1.577148 C 8.70931 1.795248 9.075521 2.102865 9.375 2.5 L 10.3125 3.75 L 16.875 3.75 C 17.239582 3.75 17.591145 3.813477 17.929688 3.94043 C 18.268229 4.067383 18.574219 4.241537 18.847656 4.462891 C 19.121094 4.684246 19.35384 4.947918 19.545898 5.253906 C 19.737955 5.559896 19.869791 5.891928 19.941406 6.25 L 18.642578 6.25 C 18.577473 6.061199 18.486328 5.890301 18.369141 5.737305 C 18.251953 5.584311 18.115234 5.452475 17.958984 5.341797 C 17.802734 5.231121 17.633463 5.146485 17.451172 5.087891 C 17.268879 5.029298 17.076822 5.000001 16.875 5 L 10.185547 5 C 9.951172 5.156251 9.728189 5.309246 9.516602 5.458984 C 9.305013 5.608725 9.086914 5.742188 8.862305 5.859375 C 8.637695 5.976562 8.404947 6.070964 8.164062 6.142578 C 7.923177 6.214193 7.65625 6.25 7.363281 6.25 L 1.25 6.25 L 1.25 15.625 C 1.25 15.878906 1.298828 16.119791 1.396484 16.347656 C 1.494141 16.575521 1.629232 16.775717 1.801758 16.948242 C 1.974284 17.120768 2.174479 17.255859 2.402344 17.353516 C 2.630208 17.451172 2.871094 17.5 3.125 17.5 L 8.613281 17.5 C 8.684896 17.721354 8.769531 17.936197 8.867188 18.144531 C 8.964844 18.352865 9.075521 18.554688 9.199219 18.75 Z M 7.363281 5 C 7.539062 5.000001 7.70345 4.977215 7.856445 4.931641 C 8.009439 4.886068 8.154297 4.825847 8.291016 4.750977 C 8.427734 4.676107 8.562825 4.5931 8.696289 4.501953 C 8.829752 4.410808 8.964844 4.316406 9.101562 4.21875 C 8.945312 4.010417 8.795572 3.803711 8.652344 3.598633 C 8.509114 3.393555 8.354492 3.209637 8.188477 3.046875 C 8.022461 2.884115 7.833658 2.752279 7.62207 2.651367 C 7.410481 2.550457 7.161458 2.5 6.875 2.5 L 3.125 2.5 C 2.871094 2.5 2.630208 2.548828 2.402344 2.646484 C 2.174479 2.744141 1.974284 2.879232 1.801758 3.051758 C 1.629232 3.224285 1.494141 3.42448 1.396484 3.652344 C 1.298828 3.880209 1.25 4.121094 1.25 4.375 L 1.25 5 Z M 11.865234 9.375 L 11.865234 9.306641 C 11.865234 8.883464 11.949869 8.486328 12.119141 8.115234 C 12.288411 7.744141 12.516275 7.420248 12.802734 7.143555 C 13.089192 6.866863 13.421224 6.648764 13.798828 6.489258 C 14.176432 6.329753 14.573567 6.25 14.990234 6.25 C 15.426432 6.25 15.833332 6.331381 16.210938 6.494141 C 16.588541 6.656901 16.918945 6.879883 17.202148 7.163086 C 17.485352 7.446289 17.708332 7.776693 17.871094 8.154297 C 18.033854 8.531901 18.115234 8.938803 18.115234 9.375 C 18.115234 9.811198 18.033854 10.2181 17.871094 10.595703 C 17.708332 10.973308 17.485352 11.303711 17.202148 11.586914 C 16.918945 11.870117 16.588541 12.0931 16.210938 12.255859 C 15.833332 12.41862 15.426432 12.5 14.990234 12.5 C 14.554036 12.5 14.147135 12.41862 13.769531 12.255859 C 13.391927 12.0931 13.061523 11.870117 12.77832 11.586914 C 12.495117 11.303711 12.272135 10.973308 12.109375 10.595703 C 11.946614 10.2181 11.865234 9.811198 11.865234 9.375 Z M 12.021484 13.75 L 17.958984 13.75 C 18.238932 13.75 18.500977 13.803711 18.745117 13.911133 C 18.989258 14.018555 19.204102 14.165039 19.389648 14.350586 C 19.575195 14.536133 19.72168 14.750977 19.829102 14.995117 C 19.936523 15.239258 19.990234 15.501303 19.990234 15.78125 L 19.990234 16.25 C 19.990234 16.653646 19.918619 17.026367 19.775391 17.368164 C 19.63216 17.709961 19.436848 18.019205 19.189453 18.295898 C 18.942057 18.572592 18.657227 18.818359 18.334961 19.033203 C 18.012695 19.248047 17.66927 19.427084 17.304688 19.570312 C 16.940104 19.713541 16.56901 19.820963 16.191406 19.892578 C 15.813802 19.964193 15.449219 20 15.097656 20 L 14.882812 20 C 14.544271 20 14.187825 19.964193 13.813477 19.892578 C 13.439127 19.820963 13.071289 19.71517 12.709961 19.575195 C 12.348633 19.435221 12.00358 19.261068 11.674805 19.052734 C 11.346028 18.8444 11.056314 18.603516 10.805664 18.330078 C 10.555013 18.056641 10.356445 17.752279 10.209961 17.416992 C 10.063477 17.081705 9.990234 16.71875 9.990234 16.328125 L 9.990234 15.78125 C 9.990234 15.501303 10.043945 15.239258 10.151367 14.995117 C 10.258789 14.750977 10.405273 14.536133 10.59082 14.350586 C 10.776367 14.165039 10.991211 14.018555 11.235352 13.911133 C 11.479492 13.803711 11.741536 13.75 12.021484 13.75 Z " />
                        </Viewbox>
                        <TextBlock
                            Grid.Column="1"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontWeight="SemiBold"
                            Text="Message list is empty" />
                    </Grid>
                </Grid>
            </ListView.Header>
            <Interactivity:Interaction.Behaviors>
                <behaviors:ListViewMultiSelectBehavior SelectedItems="{x:Bind ViewModel.SelectedMessages, Mode=TwoWay}" />
            </Interactivity:Interaction.Behaviors>
        </ListView>

        <controls:GridSplitter Grid.Column="1" Opacity="0.5" />

        <!--  Right Content  -->

        <!--  Single selection.  -->
        <Grid Grid.Column="2" Visibility="{x:Bind ViewModel.HasSelectedSingleMessage, Mode=OneWay}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!--  Draft warning  -->
            <!--  Mail actions bar  -->
            <CommandBar
                HorizontalContentAlignment="Stretch"
                VerticalContentAlignment="Stretch"
                DefaultLabelPosition="Right"
                Visibility="{x:Bind ViewModel.HasSelectedSingleMessage, Mode=OneWay}">
                <CommandBar.Content>
                    <!--  Subject  -->
                    <Grid Padding="12,0">
                        <TextBlock
                            VerticalAlignment="Center"
                            FontSize="16"
                            FontWeight="SemiBold"
                            Text="{x:Bind ViewModel.SelectedSingleMessage.Subject, Mode=OneWay}" />
                    </Grid>
                    <!--<InfoBar
                        Grid.Row="0"
                        Margin="12,4,12,0"
                        IsOpen="{x:Bind ViewModel.IsDraftMessage, Mode=OneWay}"
                        Message="This is a draft message."
                        Visibility="{x:Bind ViewModel.IsDraftMessage, Mode=OneWay}">
                        <InfoBar.ActionButton>
                            <Button Command="{x:Bind ViewModel.EditDraftMessageCommand}" Content="Edit" />
                        </InfoBar.ActionButton>
                    </InfoBar>-->
                </CommandBar.Content>
                <CommandBar.PrimaryCommands>
                    <AppBarButton
                        Command="{x:Bind ViewModel.ForwardCommand}"
                        Label="Forward"
                        Visibility="{x:Bind ViewModel.IsNotDraftMessage, Mode=OneWay}">
                        <AppBarButton.Icon>
                            <PathIcon Data="F1 M 3.056641 18.75 C 2.646484 18.75 2.255859 18.666992 1.884766 18.500977 C 1.513672 18.334961 1.189779 18.113607 0.913086 17.836914 C 0.636393 17.560221 0.415039 17.236328 0.249023 16.865234 C 0.083008 16.494141 0 16.103516 0 15.693359 L 0 5.556641 C 0 5.146485 0.083008 4.75586 0.249023 4.384766 C 0.415039 4.013673 0.636393 3.689779 0.913086 3.413086 C 1.189779 3.136395 1.513672 2.915039 1.884766 2.749023 C 2.255859 2.583008 2.646484 2.5 3.056641 2.5 L 16.943359 2.5 C 17.353516 2.5 17.744141 2.583008 18.115234 2.749023 C 18.486328 2.915039 18.810221 3.136395 19.086914 3.413086 C 19.363605 3.689779 19.584961 4.013673 19.750977 4.384766 C 19.916992 4.75586 20 5.146485 20 5.556641 L 20 9.902344 C 19.817707 9.674479 19.622395 9.456381 19.414062 9.248047 C 19.205729 9.039714 18.984375 8.847656 18.75 8.671875 L 18.75 7.353516 L 17.685547 7.988281 C 17.229816 7.753907 16.735025 7.565105 16.201172 7.421875 L 18.75 5.898438 L 18.75 5.625 C 18.75 5.371094 18.701172 5.130209 18.603516 4.902344 C 18.505859 4.67448 18.370768 4.474285 18.198242 4.301758 C 18.025715 4.129232 17.82552 3.994141 17.597656 3.896484 C 17.369791 3.798828 17.128906 3.75 16.875 3.75 L 3.125 3.75 C 2.871094 3.75 2.630208 3.798828 2.402344 3.896484 C 2.174479 3.994141 1.974284 4.129232 1.801758 4.301758 C 1.629232 4.474285 1.494141 4.67448 1.396484 4.902344 C 1.298828 5.130209 1.25 5.371094 1.25 5.625 L 1.25 5.898438 L 8.496094 10.244141 C 8.372396 10.413412 8.258463 10.589193 8.154297 10.771484 C 8.05013 10.953776 7.952474 11.139323 7.861328 11.328125 L 1.25 7.353516 L 1.25 15.625 C 1.25 15.878906 1.298828 16.119791 1.396484 16.347656 C 1.494141 16.575521 1.629232 16.775717 1.801758 16.948242 C 1.974284 17.120768 2.174479 17.255859 2.402344 17.353516 C 2.630208 17.451172 2.871094 17.5 3.125 17.5 L 7.900391 17.5 C 8.011067 17.721354 8.129883 17.936197 8.256836 18.144531 C 8.383789 18.352865 8.522135 18.554688 8.671875 18.75 Z M 8.75 14.375 C 8.75 13.600261 8.898111 12.871094 9.194336 12.1875 C 9.49056 11.503906 9.892578 10.908203 10.400391 10.400391 C 10.908203 9.892578 11.503906 9.490561 12.1875 9.194336 C 12.871093 8.898112 13.60026 8.75 14.375 8.75 C 14.889322 8.75 15.385741 8.816732 15.864258 8.950195 C 16.342773 9.083659 16.790363 9.272461 17.207031 9.516602 C 17.623697 9.760742 18.004557 10.055339 18.349609 10.400391 C 18.69466 10.745443 18.989258 11.126303 19.233398 11.542969 C 19.477539 11.959636 19.66634 12.407227 19.799805 12.885742 C 19.933268 13.364258 20 13.860678 20 14.375 C 20 15.14974 19.851887 15.878906 19.555664 16.5625 C 19.259439 17.246094 18.857422 17.841797 18.349609 18.349609 C 17.841797 18.857422 17.246094 19.259439 16.5625 19.555664 C 15.878906 19.851889 15.149739 20 14.375 20 C 13.59375 20 12.861328 19.853516 12.177734 19.560547 C 11.494141 19.267578 10.898438 18.867188 10.390625 18.359375 C 9.882812 17.851562 9.482422 17.255859 9.189453 16.572266 C 8.896484 15.888672 8.75 15.15625 8.75 14.375 Z M 14.375 17.578125 C 14.570312 17.578125 14.736328 17.509766 14.873047 17.373047 L 17.373047 14.873047 C 17.509766 14.736328 17.578125 14.570312 17.578125 14.375 C 17.578125 14.179688 17.509766 14.013672 17.373047 13.876953 L 14.873047 11.376953 C 14.736328 11.240234 14.570312 11.171875 14.375 11.171875 C 14.179688 11.171875 14.013672 11.240234 13.876953 11.376953 C 13.740234 11.513672 13.671875 11.679688 13.671875 11.875 C 13.671875 12.070312 13.740234 12.236328 13.876953 12.373047 L 15.253906 13.75 L 11.875 13.75 C 11.705729 13.75 11.559244 13.81185 11.435547 13.935547 C 11.311849 14.059245 11.25 14.205729 11.25 14.375 C 11.25 14.544271 11.311849 14.690756 11.435547 14.814453 C 11.559244 14.938151 11.705729 15 11.875 15 L 15.253906 15 L 13.876953 16.376953 C 13.740234 16.513672 13.671875 16.679688 13.671875 16.875 C 13.671875 17.070312 13.740234 17.236328 13.876953 17.373047 C 14.013672 17.509766 14.179688 17.578125 14.375 17.578125 Z " />
                        </AppBarButton.Icon>
                    </AppBarButton>

                    <AppBarButton
                        Command="{x:Bind ViewModel.ReplyCommand}"
                        Label="Reply"
                        Visibility="{x:Bind ViewModel.IsNotDraftMessage, Mode=OneWay}">
                        <AppBarButton.Icon>
                            <PathIcon Data="F1 M 3.056641 18.75 C 2.646484 18.75 2.255859 18.666992 1.884766 18.500977 C 1.513672 18.334961 1.189779 18.113607 0.913086 17.836914 C 0.636393 17.560221 0.415039 17.236328 0.249023 16.865234 C 0.083008 16.494141 0 16.103516 0 15.693359 L 0 5.556641 C 0 5.146485 0.083008 4.75586 0.249023 4.384766 C 0.415039 4.013673 0.636393 3.689779 0.913086 3.413086 C 1.189779 3.136395 1.513672 2.915039 1.884766 2.749023 C 2.255859 2.583008 2.646484 2.5 3.056641 2.5 L 16.943359 2.5 C 17.353516 2.5 17.744141 2.583008 18.115234 2.749023 C 18.486328 2.915039 18.810221 3.136395 19.086914 3.413086 C 19.363605 3.689779 19.584961 4.013673 19.750977 4.384766 C 19.916992 4.75586 20 5.146485 20 5.556641 L 20 9.902344 C 19.817707 9.674479 19.622395 9.456381 19.414062 9.248047 C 19.205729 9.039714 18.984375 8.847656 18.75 8.671875 L 18.75 7.353516 L 17.685547 7.988281 C 17.229816 7.753907 16.735025 7.565105 16.201172 7.421875 L 18.75 5.898438 L 18.75 5.625 C 18.75 5.371094 18.701172 5.130209 18.603516 4.902344 C 18.505859 4.67448 18.370768 4.474285 18.198242 4.301758 C 18.025715 4.129232 17.82552 3.994141 17.597656 3.896484 C 17.369791 3.798828 17.128906 3.75 16.875 3.75 L 3.125 3.75 C 2.871094 3.75 2.630208 3.798828 2.402344 3.896484 C 2.174479 3.994141 1.974284 4.129232 1.801758 4.301758 C 1.629232 4.474285 1.494141 4.67448 1.396484 4.902344 C 1.298828 5.130209 1.25 5.371094 1.25 5.625 L 1.25 5.898438 L 8.496094 10.244141 C 8.372396 10.413412 8.258463 10.589193 8.154297 10.771484 C 8.05013 10.953776 7.952474 11.139323 7.861328 11.328125 L 1.25 7.353516 L 1.25 15.625 C 1.25 15.878906 1.298828 16.119791 1.396484 16.347656 C 1.494141 16.575521 1.629232 16.775717 1.801758 16.948242 C 1.974284 17.120768 2.174479 17.255859 2.402344 17.353516 C 2.630208 17.451172 2.871094 17.5 3.125 17.5 L 7.900391 17.5 C 8.011067 17.721354 8.129883 17.936197 8.256836 18.144531 C 8.383789 18.352865 8.522135 18.554688 8.671875 18.75 Z M 8.75 14.375 C 8.75 13.600261 8.898111 12.871094 9.194336 12.1875 C 9.49056 11.503906 9.892578 10.908203 10.400391 10.400391 C 10.908203 9.892578 11.503906 9.490561 12.1875 9.194336 C 12.871093 8.898112 13.60026 8.75 14.375 8.75 C 14.889322 8.75 15.385741 8.816732 15.864258 8.950195 C 16.342773 9.083659 16.790363 9.272461 17.207031 9.516602 C 17.623697 9.760742 18.004557 10.055339 18.349609 10.400391 C 18.69466 10.745443 18.989258 11.126303 19.233398 11.542969 C 19.477539 11.959636 19.66634 12.407227 19.799805 12.885742 C 19.933268 13.364258 20 13.860678 20 14.375 C 20 15.14974 19.851887 15.878906 19.555664 16.5625 C 19.259439 17.246094 18.857422 17.841797 18.349609 18.349609 C 17.841797 18.857422 17.246094 19.259439 16.5625 19.555664 C 15.878906 19.851889 15.149739 20 14.375 20 C 13.59375 20 12.861328 19.853516 12.177734 19.560547 C 11.494141 19.267578 10.898438 18.867188 10.390625 18.359375 C 9.882812 17.851562 9.482422 17.255859 9.189453 16.572266 C 8.896484 15.888672 8.75 15.15625 8.75 14.375 Z M 17.5 16.513672 C 17.5 16.136068 17.423502 15.779623 17.270508 15.444336 C 17.117512 15.10905 16.912434 14.816081 16.655273 14.56543 C 16.398111 14.314779 16.098633 14.116211 15.756836 13.969727 C 15.415039 13.823242 15.058594 13.75 14.6875 13.75 L 12.246094 13.75 L 13.623047 12.373047 C 13.759765 12.236328 13.828124 12.070312 13.828125 11.875 C 13.828124 11.679688 13.759765 11.513672 13.623047 11.376953 C 13.486327 11.240234 13.320312 11.171875 13.125 11.171875 C 12.929687 11.171875 12.763671 11.240234 12.626953 11.376953 L 10.126953 13.876953 C 9.990234 14.013672 9.921875 14.179688 9.921875 14.375 C 9.921875 14.570312 9.990234 14.736328 10.126953 14.873047 L 12.626953 17.373047 C 12.763671 17.509766 12.929687 17.578125 13.125 17.578125 C 13.320312 17.578125 13.486327 17.509766 13.623047 17.373047 C 13.759765 17.236328 13.828124 17.070312 13.828125 16.875 C 13.828124 16.679688 13.759765 16.513672 13.623047 16.376953 L 12.246094 15 L 14.6875 15 C 14.902344 15 15.104166 15.042318 15.292969 15.126953 C 15.481771 15.211589 15.646158 15.323894 15.786133 15.463867 C 15.926105 15.603842 16.03841 15.768229 16.123047 15.957031 C 16.207682 16.145834 16.25 16.347656 16.25 16.5625 C 16.25 16.673178 16.25651 16.785482 16.269531 16.899414 C 16.282551 17.013346 16.310221 17.114258 16.352539 17.202148 C 16.394855 17.290039 16.456705 17.361654 16.538086 17.416992 C 16.619465 17.47233 16.73177 17.5 16.875 17.5 C 17.024738 17.5 17.141926 17.470703 17.226562 17.412109 C 17.311197 17.353516 17.373047 17.277018 17.412109 17.182617 C 17.451172 17.088217 17.475586 16.982422 17.485352 16.865234 C 17.495117 16.748047 17.5 16.630859 17.5 16.513672 Z " />
                        </AppBarButton.Icon>
                    </AppBarButton>

                    <AppBarButton
                        Command="{x:Bind ViewModel.ReplyAllCommand}"
                        Label="Reply All"
                        Visibility="{x:Bind ViewModel.ShouldDisplayReplyAll, Mode=OneWay}">
                        <AppBarButton.Icon>
                            <PathIcon Data="F1 M 3.056641 18.75 C 2.646484 18.75 2.255859 18.666992 1.884766 18.500977 C 1.513672 18.334961 1.189779 18.113607 0.913086 17.836914 C 0.636393 17.560221 0.415039 17.236328 0.249023 16.865234 C 0.083008 16.494141 0 16.103516 0 15.693359 L 0 5.556641 C 0 5.146485 0.083008 4.75586 0.249023 4.384766 C 0.415039 4.013673 0.636393 3.689779 0.913086 3.413086 C 1.189779 3.136395 1.513672 2.915039 1.884766 2.749023 C 2.255859 2.583008 2.646484 2.5 3.056641 2.5 L 16.943359 2.5 C 17.353516 2.5 17.744141 2.583008 18.115234 2.749023 C 18.486328 2.915039 18.810221 3.136395 19.086914 3.413086 C 19.363605 3.689779 19.584961 4.013673 19.750977 4.384766 C 19.916992 4.75586 20 5.146485 20 5.556641 L 20 9.902344 C 19.817707 9.674479 19.622395 9.456381 19.414062 9.248047 C 19.205729 9.039714 18.984375 8.847656 18.75 8.671875 L 18.75 7.353516 L 17.685547 7.988281 C 17.229816 7.753907 16.735025 7.565105 16.201172 7.421875 L 18.75 5.898438 L 18.75 5.625 C 18.75 5.371094 18.701172 5.130209 18.603516 4.902344 C 18.505859 4.67448 18.370768 4.474285 18.198242 4.301758 C 18.025715 4.129232 17.82552 3.994141 17.597656 3.896484 C 17.369791 3.798828 17.128906 3.75 16.875 3.75 L 3.125 3.75 C 2.871094 3.75 2.630208 3.798828 2.402344 3.896484 C 2.174479 3.994141 1.974284 4.129232 1.801758 4.301758 C 1.629232 4.474285 1.494141 4.67448 1.396484 4.902344 C 1.298828 5.130209 1.25 5.371094 1.25 5.625 L 1.25 5.898438 L 8.496094 10.244141 C 8.372396 10.413412 8.258463 10.589193 8.154297 10.771484 C 8.05013 10.953776 7.952474 11.139323 7.861328 11.328125 L 1.25 7.353516 L 1.25 15.625 C 1.25 15.878906 1.298828 16.119791 1.396484 16.347656 C 1.494141 16.575521 1.629232 16.775717 1.801758 16.948242 C 1.974284 17.120768 2.174479 17.255859 2.402344 17.353516 C 2.630208 17.451172 2.871094 17.5 3.125 17.5 L 7.900391 17.5 C 8.011067 17.721354 8.129883 17.936197 8.256836 18.144531 C 8.383789 18.352865 8.522135 18.554688 8.671875 18.75 Z M 8.75 14.375 C 8.75 13.600261 8.898111 12.871094 9.194336 12.1875 C 9.49056 11.503906 9.892578 10.908203 10.400391 10.400391 C 10.908203 9.892578 11.503906 9.490561 12.1875 9.194336 C 12.871093 8.898112 13.60026 8.75 14.375 8.75 C 14.889322 8.75 15.385741 8.816732 15.864258 8.950195 C 16.342773 9.083659 16.790363 9.272461 17.207031 9.516602 C 17.623697 9.760742 18.004557 10.055339 18.349609 10.400391 C 18.69466 10.745443 18.989258 11.126303 19.233398 11.542969 C 19.477539 11.959636 19.66634 12.407227 19.799805 12.885742 C 19.933268 13.364258 20 13.860678 20 14.375 C 20 15.14974 19.851887 15.878906 19.555664 16.5625 C 19.259439 17.246094 18.857422 17.841797 18.349609 18.349609 C 17.841797 18.857422 17.246094 19.259439 16.5625 19.555664 C 15.878906 19.851889 15.149739 20 14.375 20 C 13.59375 20 12.861328 19.853516 12.177734 19.560547 C 11.494141 19.267578 10.898438 18.867188 10.390625 18.359375 C 9.882812 17.851562 9.482422 17.255859 9.189453 16.572266 C 8.896484 15.888672 8.75 15.15625 8.75 14.375 Z M 12.5 17.578125 C 12.695312 17.578125 12.861328 17.509766 12.998047 17.373047 C 13.134766 17.236328 13.203125 17.070312 13.203125 16.875 C 13.203125 16.679688 13.134766 16.513672 12.998047 16.376953 L 10.996094 14.375 L 12.998047 12.373047 C 13.134766 12.236328 13.203125 12.070312 13.203125 11.875 C 13.203125 11.679688 13.134766 11.513672 12.998047 11.376953 C 12.861328 11.240234 12.695312 11.171875 12.5 11.171875 C 12.304688 11.171875 12.138672 11.240234 12.001953 11.376953 L 9.501953 13.876953 C 9.365234 14.013672 9.296875 14.179688 9.296875 14.375 C 9.296875 14.570312 9.365234 14.736328 9.501953 14.873047 L 12.001953 17.373047 C 12.138672 17.509766 12.304688 17.578125 12.5 17.578125 Z M 18.75 16.513672 C 18.75 16.136068 18.673502 15.779623 18.520508 15.444336 C 18.367512 15.10905 18.162434 14.816081 17.905273 14.56543 C 17.648111 14.314779 17.348633 14.116211 17.006836 13.969727 C 16.665039 13.823242 16.308594 13.75 15.9375 13.75 L 14.746094 13.75 L 16.123047 12.373047 C 16.259766 12.236328 16.328125 12.070312 16.328125 11.875 C 16.328125 11.679688 16.259766 11.513672 16.123047 11.376953 C 15.986328 11.240234 15.820312 11.171875 15.625 11.171875 C 15.429688 11.171875 15.263672 11.240234 15.126953 11.376953 L 12.626953 13.876953 C 12.490233 14.013672 12.421874 14.179688 12.421875 14.375 C 12.421874 14.570312 12.490233 14.736328 12.626953 14.873047 L 15.126953 17.373047 C 15.263672 17.509766 15.429688 17.578125 15.625 17.578125 C 15.820312 17.578125 15.986328 17.509766 16.123047 17.373047 C 16.259766 17.236328 16.328125 17.070312 16.328125 16.875 C 16.328125 16.679688 16.259766 16.513672 16.123047 16.376953 L 14.746094 15 L 15.9375 15 C 16.152344 15 16.354166 15.042318 16.542969 15.126953 C 16.73177 15.211589 16.896158 15.323894 17.036133 15.463867 C 17.176105 15.603842 17.28841 15.768229 17.373047 15.957031 C 17.457682 16.145834 17.5 16.347656 17.5 16.5625 C 17.5 16.673178 17.50651 16.785482 17.519531 16.899414 C 17.532551 17.013346 17.560221 17.114258 17.602539 17.202148 C 17.644855 17.290039 17.706705 17.361654 17.788086 17.416992 C 17.869465 17.47233 17.98177 17.5 18.125 17.5 C 18.274738 17.5 18.391926 17.470703 18.476562 17.412109 C 18.561197 17.353516 18.623047 17.277018 18.662109 17.182617 C 18.701172 17.088217 18.725586 16.982422 18.735352 16.865234 C 18.745117 16.748047 18.75 16.630859 18.75 16.513672 Z " />
                        </AppBarButton.Icon>
                    </AppBarButton>

                    <AppBarButton Label="Send" Visibility="{x:Bind ViewModel.IsDraftMessage, Mode=OneWay}">
                        <AppBarButton.Icon>
                            <PathIcon Data="F1 M 20 9.375 C 20 9.498698 19.967447 9.611003 19.902344 9.711914 C 19.837238 9.812826 19.749348 9.889323 19.638672 9.941406 L 0.888672 18.691406 C 0.810547 18.730469 0.722656 18.75 0.625 18.75 C 0.442708 18.75 0.292969 18.689779 0.175781 18.569336 C 0.058594 18.448893 0 18.297525 0 18.115234 C 0 18.082682 0 18.053385 0 18.027344 C 0 18.001303 0.00651 17.97526 0.019531 17.949219 L 2.470703 9.375 L 0.019531 0.800781 C 0.00651 0.77474 0 0.748699 0 0.722656 C 0 0.696615 0 0.667318 0 0.634766 C 0 0.452475 0.058594 0.301107 0.175781 0.180664 C 0.292969 0.060223 0.442708 0 0.625 0 C 0.722656 0 0.810547 0.019531 0.888672 0.058594 L 19.638672 8.808594 C 19.879557 8.919271 20 9.108073 20 9.375 Z M 1.601562 16.982422 L 17.900391 9.375 L 1.601562 1.767578 L 3.603516 8.75 L 11.875 8.75 C 12.04427 8.75 12.190754 8.81185 12.314453 8.935547 C 12.43815 9.059245 12.5 9.205729 12.5 9.375 C 12.5 9.544271 12.43815 9.690756 12.314453 9.814453 C 12.190754 9.938151 12.04427 10 11.875 10 L 3.603516 10 Z " />
                        </AppBarButton.Icon>
                    </AppBarButton>

                    <AppBarButton
                        Command="{x:Bind ViewModel.EditDraftMessageCommand}"
                        Label="Edit"
                        Visibility="{x:Bind ViewModel.IsDraftMessage, Mode=OneWay}">
                        <AppBarButton.Icon>
                            <PathIcon Data="F1 M 19.931641 3.212891 C 19.931641 3.681641 19.84375 4.135743 19.667969 4.575195 C 19.492188 5.014649 19.238281 5.400392 18.90625 5.732422 L 6.425781 18.212891 C 6.347656 18.291016 6.258138 18.356119 6.157227 18.408203 C 6.056314 18.460287 5.950521 18.502604 5.839844 18.535156 L 1.005859 19.746094 C 0.940755 19.759115 0.891927 19.765625 0.859375 19.765625 C 0.690104 19.765625 0.54362 19.705404 0.419922 19.584961 C 0.296224 19.464518 0.234375 19.319662 0.234375 19.150391 C 0.234375 19.111328 0.240885 19.059244 0.253906 18.994141 L 1.464844 14.160156 C 1.497396 14.049479 1.539714 13.943686 1.591797 13.842773 C 1.64388 13.741862 1.708984 13.652344 1.787109 13.574219 L 14.404297 0.957031 C 14.710286 0.651043 15.066731 0.415039 15.473633 0.249023 C 15.880533 0.083008 16.298828 0 16.728516 0 C 17.177734 0 17.597656 0.083008 17.988281 0.249023 C 18.378906 0.415039 18.719074 0.642904 19.008789 0.932617 C 19.298502 1.222332 19.524738 1.5625 19.6875 1.953125 C 19.85026 2.34375 19.931641 2.763672 19.931641 3.212891 Z M 18.681641 3.251953 C 18.681641 2.972006 18.634439 2.709961 18.540039 2.46582 C 18.445637 2.22168 18.312174 2.008465 18.139648 1.826172 C 17.967121 1.643881 17.760416 1.502279 17.519531 1.401367 C 17.278645 1.300457 17.014973 1.25 16.728516 1.25 C 16.481119 1.25 16.26302 1.28418 16.074219 1.352539 C 15.885416 1.420898 15.711262 1.513672 15.551758 1.630859 C 15.392252 1.748047 15.240885 1.881512 15.097656 2.03125 C 14.954426 2.18099 14.801432 2.33724 14.638672 2.5 L 17.5 5.361328 C 17.66276 5.205078 17.815754 5.052084 17.958984 4.902344 C 18.102213 4.752605 18.227539 4.596355 18.334961 4.433594 C 18.442383 4.270834 18.527018 4.095053 18.588867 3.90625 C 18.650715 3.717449 18.681641 3.49935 18.681641 3.251953 Z M 1.71875 18.28125 L 5.537109 17.324219 L 16.621094 6.240234 L 13.759766 3.378906 L 2.675781 14.462891 Z " />
                        </AppBarButton.Icon>
                    </AppBarButton>

                    <AppBarButton Command="{x:Bind ViewModel.DeleteCommand}" Label="Delete">
                        <AppBarButton.Icon>
                            <PathIcon Data="F1 M 19.375 3.125 C 19.375 3.26823 19.34733 3.382162 19.291992 3.466797 C 19.236652 3.551434 19.16341 3.61491 19.072266 3.657227 C 18.981119 3.699545 18.880207 3.727215 18.769531 3.740234 C 18.658854 3.753256 18.544922 3.759766 18.427734 3.759766 C 18.362629 3.759766 18.297525 3.758139 18.232422 3.754883 C 18.167316 3.751629 18.108723 3.75 18.056641 3.75 L 16.435547 17.783203 C 16.396484 18.095703 16.305338 18.387045 16.162109 18.657227 C 16.018879 18.927408 15.836588 19.161783 15.615234 19.360352 C 15.39388 19.55892 15.139974 19.71517 14.853516 19.829102 C 14.567057 19.943033 14.267578 20 13.955078 20 L 6.044922 20 C 5.732422 20 5.432942 19.943033 5.146484 19.829102 C 4.860026 19.71517 4.60612 19.55892 4.384766 19.360352 C 4.163411 19.161783 3.98112 18.927408 3.837891 18.657227 C 3.694661 18.387045 3.603516 18.095703 3.564453 17.783203 L 1.943359 3.75 C 1.910807 3.75 1.878255 3.75 1.845703 3.75 L 1.650391 3.759766 C 1.617839 3.759766 1.585286 3.759766 1.552734 3.759766 C 1.442057 3.759766 1.33138 3.753256 1.220703 3.740234 C 1.110026 3.727215 1.010742 3.697918 0.922852 3.652344 C 0.834961 3.606771 0.763346 3.541668 0.708008 3.457031 C 0.652669 3.372396 0.625 3.261719 0.625 3.125 C 0.625 2.95573 0.686849 2.809246 0.810547 2.685547 C 0.934245 2.56185 1.080729 2.5 1.25 2.5 L 6.933594 2.5 C 6.998697 2.141928 7.127278 1.809896 7.319336 1.503906 C 7.511393 1.197918 7.745768 0.932617 8.022461 0.708008 C 8.299153 0.483398 8.606771 0.309246 8.945312 0.185547 C 9.283854 0.06185 9.635416 0 10 0 C 10.364583 0 10.716146 0.06185 11.054688 0.185547 C 11.393229 0.309246 11.700846 0.483398 11.977539 0.708008 C 12.25423 0.932617 12.488605 1.197918 12.680664 1.503906 C 12.872721 1.809896 13.001302 2.141928 13.066406 2.5 L 18.75 2.5 C 18.91927 2.5 19.065754 2.56185 19.189453 2.685547 C 19.31315 2.809246 19.375 2.95573 19.375 3.125 Z M 8.232422 2.5 L 11.767578 2.5 C 11.702474 2.311199 11.611328 2.140301 11.494141 1.987305 C 11.376953 1.834311 11.240234 1.702475 11.083984 1.591797 C 10.927734 1.481121 10.758463 1.396484 10.576172 1.337891 C 10.39388 1.279297 10.201822 1.25 10 1.25 C 9.798177 1.25 9.606119 1.279297 9.423828 1.337891 C 9.241536 1.396484 9.072266 1.481121 8.916016 1.591797 C 8.759766 1.702475 8.623047 1.834311 8.505859 1.987305 C 8.388672 2.140301 8.297525 2.311199 8.232422 2.5 Z M 16.796875 3.75 L 3.203125 3.75 L 4.804688 17.646484 C 4.84375 17.972006 4.978841 18.237305 5.209961 18.442383 C 5.441081 18.647461 5.719401 18.75 6.044922 18.75 L 13.955078 18.75 C 14.111328 18.75 14.261067 18.72233 14.404297 18.666992 C 14.547525 18.611654 14.674479 18.535156 14.785156 18.4375 C 14.895833 18.339844 14.986979 18.222656 15.058594 18.085938 C 15.130208 17.949219 15.175781 17.802734 15.195312 17.646484 Z M 7.5 14.375 L 7.5 8.125 C 7.5 7.95573 7.561849 7.809246 7.685547 7.685547 C 7.809245 7.56185 7.955729 7.5 8.125 7.5 C 8.294271 7.5 8.440755 7.56185 8.564453 7.685547 C 8.68815 7.809246 8.75 7.95573 8.75 8.125 L 8.75 14.375 C 8.75 14.544271 8.68815 14.690756 8.564453 14.814453 C 8.440755 14.938151 8.294271 15 8.125 15 C 7.955729 15 7.809245 14.938151 7.685547 14.814453 C 7.561849 14.690756 7.5 14.544271 7.5 14.375 Z M 11.25 14.375 L 11.25 8.125 C 11.25 7.95573 11.311849 7.809246 11.435547 7.685547 C 11.559244 7.56185 11.705729 7.5 11.875 7.5 C 12.04427 7.5 12.190754 7.56185 12.314453 7.685547 C 12.43815 7.809246 12.5 7.95573 12.5 8.125 L 12.5 14.375 C 12.5 14.544271 12.43815 14.690756 12.314453 14.814453 C 12.190754 14.938151 12.04427 15 11.875 15 C 11.705729 15 11.559244 14.938151 11.435547 14.814453 C 11.311849 14.690756 11.25 14.544271 11.25 14.375 Z " />
                        </AppBarButton.Icon>
                    </AppBarButton>

                </CommandBar.PrimaryCommands>
            </CommandBar>

            <!--  No message selected  -->
            <StackPanel
                Grid.Row="1"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Opacity="0.6"
                Spacing="4"
                Visibility="{x:Bind ViewModel.HasNoSelectedMessage, Mode=OneWay}">
                <Viewbox Width="28">
                    <PathIcon
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Data="F1 M 16.943359 2.5 C 17.353516 2.5 17.744141 2.583008 18.115234 2.749023 C 18.486328 2.915039 18.810221 3.136395 19.086914 3.413086 C 19.363605 3.689779 19.584961 4.013673 19.750977 4.384766 C 19.916992 4.75586 20 5.146485 20 5.556641 L 20 15.693359 C 20 16.103516 19.916992 16.494141 19.750977 16.865234 C 19.584961 17.236328 19.363605 17.560221 19.086914 17.836914 C 18.810221 18.113607 18.486328 18.334961 18.115234 18.500977 C 17.744141 18.666992 17.353516 18.75 16.943359 18.75 L 3.056641 18.75 C 2.646484 18.75 2.255859 18.666992 1.884766 18.500977 C 1.513672 18.334961 1.189779 18.113607 0.913086 17.836914 C 0.636393 17.560221 0.415039 17.236328 0.249023 16.865234 C 0.083008 16.494141 0 16.103516 0 15.693359 L 0 5.556641 C 0 5.146485 0.083008 4.75586 0.249023 4.384766 C 0.415039 4.013673 0.636393 3.689779 0.913086 3.413086 C 1.189779 3.136395 1.513672 2.915039 1.884766 2.749023 C 2.255859 2.583008 2.646484 2.5 3.056641 2.5 Z M 3.125 3.75 C 2.871094 3.75 2.630208 3.798828 2.402344 3.896484 C 2.174479 3.994141 1.974284 4.129232 1.801758 4.301758 C 1.629232 4.474285 1.494141 4.67448 1.396484 4.902344 C 1.298828 5.130209 1.25 5.371094 1.25 5.625 L 1.25 5.898438 L 10 11.142578 L 18.75 5.898438 L 18.75 5.625 C 18.75 5.371094 18.701172 5.130209 18.603516 4.902344 C 18.505859 4.67448 18.370768 4.474285 18.198242 4.301758 C 18.025715 4.129232 17.82552 3.994141 17.597656 3.896484 C 17.369791 3.798828 17.128906 3.75 16.875 3.75 Z M 16.875 17.5 C 17.128906 17.5 17.369791 17.451172 17.597656 17.353516 C 17.82552 17.255859 18.025715 17.120768 18.198242 16.948242 C 18.370768 16.775717 18.505859 16.575521 18.603516 16.347656 C 18.701172 16.119791 18.75 15.878906 18.75 15.625 L 18.75 7.353516 L 10.322266 12.412109 C 10.224609 12.470703 10.117188 12.5 10 12.5 C 9.882812 12.5 9.775391 12.470703 9.677734 12.412109 L 1.25 7.353516 L 1.25 15.625 C 1.25 15.878906 1.298828 16.119791 1.396484 16.347656 C 1.494141 16.575521 1.629232 16.775717 1.801758 16.948242 C 1.974284 17.120768 2.174479 17.255859 2.402344 17.353516 C 2.630208 17.451172 2.871094 17.5 3.125 17.5 Z "
                        Foreground="Gray" />
                </Viewbox>
                <TextBlock
                    FontSize="17"
                    FontWeight="Normal"
                    Foreground="Gray"
                    HorizontalTextAlignment="Center"
                    Style="{StaticResource SubtitleTextBlockStyle}"
                    Text="No message selected"
                    TextWrapping="WrapWholeWords" />
            </StackPanel>


            <!--  Message details  -->
            <Grid
                Grid.Row="1"
                Padding="12,0"
                Visibility="{x:Bind ViewModel.HasSelectedSingleMessage, Mode=OneWay}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!--  Sender / Readers  -->
                <Grid
                    Grid.Row="1"
                    Margin="0,12"
                    ColumnSpacing="12">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="48" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <PersonPicture
                        Width="48"
                        DisplayName="{x:Bind ViewModel.SelectedSingleMessage.ContactViewModel.ContactDisplayName, Mode=OneWay}"
                        Initials="{x:Bind ViewModel.SelectedSingleMessage.ContactViewModel.Initials, Mode=OneWay}"
                        ProfilePicture="{x:Bind ViewModel.SelectedSingleMessage.ContactViewModel.ProfileThumbnailUrl, Mode=OneWay, Converter={StaticResource ProfileImageConverter}}" />

                    <Grid Grid.Column="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <!--  Sender name/address  -->
                        <HyperlinkButton
                            Margin="-2,0,0,0"
                            Padding="6,2,4,4"
                            Command="{x:Bind ViewModel.DisplaySenderCommand}"
                            CommandParameter="{x:Bind ViewModel.SelectedSingleMessage.ContactViewModel.Contact, Mode=OneWay}"
                            Foreground="{ThemeResource ApplicationForegroundThemeBrush}">
                            <TextBlock>
                                <Run FontWeight="SemiBold" Text="{x:Bind ViewModel.SelectedSingleMessage.ContactViewModel.ContactDisplayName, Mode=OneWay}" />
                                <Run
                                    FontSize="14"
                                    Foreground="{ThemeResource DetailForegroundBrush}"
                                    Text="{x:Bind ViewModel.SelectedSingleMessage.ContactViewModel.Contact.Address, Mode=OneWay}" />
                            </TextBlock>
                        </HyperlinkButton>

                        <!--<ScrollViewer
                            Grid.Row="1"
                            MaxHeight="200"
                            Margin="0,2,0,0"
                            VerticalScrollBarVisibility="Hidden">
                            <ItemsControl ItemTemplate="{StaticResource ReaderTemplate}" ItemsSource="{x:Bind ViewModel.SelectedMessage.ReaderViewModels, Mode=OneWay}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <ItemsStackPanel Orientation="Horizontal" />
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                            </ItemsControl>
                        </ScrollViewer>-->

                        <!--  Receive Date  -->
                        <TextBlock
                            Grid.Column="1"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            FontSize="13"
                            Foreground="{ThemeResource DetailForegroundBrush}"
                            Text="{x:Bind helpers:XamlHelpers.GetFormattedLocalTimeDate(ViewModel.SelectedSingleMessage.CreatedAt,'g'), Mode=OneWay}" />

                        <!--  TODO: Update contact relationships between 2 accounts.  -->
                    </Grid>
                </Grid>

                <!--  Seperator  -->
                <Grid Grid.Row="2" Margin="-12,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" MinWidth="20" />
                    </Grid.ColumnDefinitions>

                    <Border
                        Height="1"
                        BorderBrush="{ThemeResource GeneralSeperatorBrush}"
                        BorderThickness="1"
                        Opacity="0.5" />

                    <StackPanel
                        Grid.Column="1"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Orientation="Horizontal"
                        Spacing="12"
                        Visibility="Collapsed">


                    </StackPanel>

                    <Border
                        Grid.Column="2"
                        Height="1"
                        HorizontalAlignment="Stretch"
                        BorderBrush="{ThemeResource GeneralSeperatorBrush}"
                        BorderThickness="1"
                        Opacity="0.5" />
                </Grid>

                <!--  Message Body  -->
                <ScrollViewer
                    Grid.Row="3"
                    VerticalAlignment="Top"
                    VerticalScrollBarVisibility="Auto">
                    <TextBlock
                        Margin="0,12"
                        IsTextSelectionEnabled="True"
                        Text="{x:Bind ViewModel.SelectedSingleMessage.Body, Mode=OneWay}"
                        TextWrapping="Wrap" />
                </ScrollViewer>

                <!--  Seperator  -->
                <Border
                    Grid.Row="4"
                    Height="1"
                    Margin="-12,0"
                    VerticalAlignment="Top"
                    BorderBrush="{ThemeResource MenuFlyoutSeparatorThemeBrush}"
                    BorderThickness="1"
                    Opacity="0.5" />

                <!--  Attachments  -->
                <ListView
                    Grid.Row="5"
                    Margin="0,12"
                    ItemTemplate="{StaticResource AttachmentTemplate}"
                    ItemsSource="{x:Bind ViewModel.SelectedSingleMessage.AttachmentViewModels, Mode=OneWay}"
                    SelectionMode="None">
                    <ListView.ItemsPanel>
                        <ItemsPanelTemplate>
                            <ItemsWrapGrid MaximumRowsOrColumns="1" />
                        </ItemsPanelTemplate>
                    </ListView.ItemsPanel>
                </ListView>
            </Grid>
        </Grid>

        <!--  Multi selection.  -->
        <Grid Grid.Column="2" Visibility="{x:Bind ViewModel.HasMultipleMessagesSelected, Mode=OneWay}">
            <StackPanel
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Spacing="6">
                <TextBlock
                    FontSize="20"
                    HorizontalTextAlignment="Center"
                    Style="{StaticResource SubheaderTextBlockStyle}"
                    TextWrapping="Wrap">
                    <Run Text="{x:Bind ViewModel.SelectedMessages.Count, Mode=OneWay}" /><Run Text=" messages selected" />
                </TextBlock>

                <!--  Regular context menu  -->
                <Grid Visibility="{x:Bind helpers:XamlHelpers.VisibilityOrReverseConverter(ViewModel.IsTrashFolder, ViewModel.IsOutboxFolder), Mode=OneWay}">
                    <Button HorizontalAlignment="Stretch" Command="{x:Bind ViewModel.DeleteCommand}">
                        <StackPanel Orientation="Horizontal" Spacing="6">
                            <FontIcon FontFamily="{StaticResource OpenEmailIconFontFamily}" Glyph="{x:Bind main:OpenEmailIcons.Trash}" />
                            <TextBlock
                                VerticalAlignment="Center"
                                FontWeight="SemiBold"
                                Text="Move to Trash" />
                        </StackPanel>
                    </Button>
                </Grid>

                <!--  Trash context menu  -->
                <Grid Visibility="{x:Bind ViewModel.IsTrashFolder, Mode=OneWay}">
                    <Button HorizontalAlignment="Stretch" Command="{x:Bind ViewModel.DeletePermanentlyCommand}">
                        <StackPanel Orientation="Horizontal" Spacing="6">
                            <FontIcon FontFamily="{StaticResource OpenEmailIconFontFamily}" Glyph="{x:Bind main:OpenEmailIcons.Trash}" />
                            <TextBlock
                                VerticalAlignment="Center"
                                FontWeight="SemiBold"
                                Text="Delete Permanently" />
                        </StackPanel>
                    </Button>
                </Grid>

                <!--  Outbox context menu  -->
                <Grid Visibility="{x:Bind ViewModel.IsOutboxFolder, Mode=OneWay}">
                    <Button HorizontalAlignment="Stretch" Command="{x:Bind ViewModel.RecallAndDeleteCommand}">
                        <StackPanel Orientation="Horizontal" Spacing="6">
                            <FontIcon FontFamily="{StaticResource OpenEmailIconFontFamily}" Glyph="{x:Bind main:OpenEmailIcons.Trash}" />
                            <TextBlock
                                VerticalAlignment="Center"
                                FontWeight="SemiBold"
                                Text="Recall and Delete" />
                        </StackPanel>
                    </Button>
                </Grid>
            </StackPanel>
        </Grid>
    </Grid>
</local:MailListPageAbstract>

