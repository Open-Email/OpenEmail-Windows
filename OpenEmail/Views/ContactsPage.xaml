<?xml version="1.0" encoding="utf-8" ?>
<local:ContactsPageAbstract
    x:Class="OpenEmail.Views.ContactsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:collections="using:CommunityToolkit.Mvvm.Collections"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:controls1="using:OpenEmail.Controls"
    xmlns:converters="using:OpenEmail.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:data="using:OpenEmail.ViewModels.Data"
    xmlns:helpers="using:OpenEmail.Helpers"
    xmlns:local="using:OpenEmail.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:root="using:OpenEmail"
    xmlns:selectors="using:OpenEmail.Selectors"
    xmlns:system="using:System"
    mc:Ignorable="d">
    <Page.Resources>
        <converters:ProfileImageConverter x:Key="ProfileImageConverter" />
        <Style x:Key="HeaderTemplateTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="15" />
            <Setter Property="FontWeight" Value="SemiBold" />
        </Style>

        <DataTemplate x:Key="ContactRequestHeaderTemplate" x:DataType="collections:IReadOnlyObservableGroup">
            <TextBlock Style="{StaticResource HeaderTemplateTextStyle}" Text="{x:Bind system:String.Format('Contact Requests ({0})', Count), Mode=OneWay}" />
        </DataTemplate>

        <DataTemplate x:Key="ContactHeaderTemplate" x:DataType="collections:IReadOnlyObservableGroup">
            <TextBlock Style="{StaticResource HeaderTemplateTextStyle}" Text="{x:Bind system:String.Format('Address Book ({0})', Count), Mode=OneWay}" />
        </DataTemplate>

        <selectors:ContactRequestHeaderTemplateSelector
            x:Key="ContactRequestHeaderTemplateSelector"
            ContactTemplate="{StaticResource ContactHeaderTemplate}"
            RequestTemplate="{StaticResource ContactRequestHeaderTemplate}" />

        <CollectionViewSource
            x:Name="ContactsCVS"
            IsSourceGrouped="True"
            Source="{x:Bind ViewModel.ContactsSource, Mode=OneWay}" />
    </Page.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" MinWidth="320" />
            <ColumnDefinition Width="1" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!--  Left Content  -->
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <ListView
                Grid.Row="1"
                ItemsSource="{x:Bind ContactsCVS.View, Mode=OneWay}"
                SelectedItem="{x:Bind ViewModel.SelectedContactViewModel, Mode=TwoWay}">
                <ListView.Header>
                    <Grid Padding="12">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <!--  Title + Add  -->
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock
                                FontSize="20"
                                FontWeight="SemiBold"
                                Text="Contacts" />

                            <Button
                                Grid.Column="1"
                                Command="{x:Bind ViewModel.AddContactCommand}"
                                Style="{StaticResource TransparentButtonStyle}">
                                <StackPanel Orientation="Horizontal" Spacing="6">
                                    <Viewbox Width="16">
                                        <PathIcon Data="F1 M 3.75 4.902344 C 3.75 4.225262 3.885091 3.588867 4.155273 2.993164 C 4.425456 2.397461 4.790039 1.878256 5.249023 1.435547 C 5.708008 0.99284 6.238606 0.642904 6.84082 0.385742 C 7.443034 0.128582 8.079427 0 8.75 0 C 9.420572 0 10.056966 0.128582 10.65918 0.385742 C 11.261393 0.642904 11.791992 0.99284 12.250977 1.435547 C 12.709961 1.878256 13.074544 2.397461 13.344727 2.993164 C 13.614908 3.588867 13.75 4.225262 13.75 4.902344 C 13.75 5.332031 13.707682 5.742188 13.623047 6.132812 C 13.538411 6.523438 13.395182 6.907553 13.193359 7.285156 C 12.307942 7.434896 11.484375 7.734375 10.722656 8.183594 C 11.295572 7.819012 11.735025 7.353517 12.041016 6.787109 C 12.347005 6.220704 12.5 5.598959 12.5 4.921875 C 12.5 4.414062 12.399088 3.937176 12.197266 3.491211 C 11.995442 3.045248 11.723633 2.65625 11.381836 2.324219 C 11.040039 1.992188 10.641275 1.730145 10.185547 1.538086 C 9.729817 1.346029 9.251302 1.25 8.75 1.25 C 8.229166 1.25 7.740885 1.347656 7.285156 1.542969 C 6.829427 1.738281 6.432292 2.005209 6.09375 2.34375 C 5.755208 2.682293 5.488281 3.079428 5.292969 3.535156 C 5.097656 3.990887 5 4.479167 5 5 C 5 5.501303 5.096028 5.979818 5.288086 6.435547 C 5.480143 6.891276 5.742188 7.290039 6.074219 7.631836 C 6.40625 7.973633 6.795247 8.245443 7.241211 8.447266 C 7.687174 8.649089 8.164062 8.75 8.671875 8.75 C 9.023438 8.75 9.360352 8.709311 9.682617 8.62793 C 10.004883 8.54655 10.322266 8.417969 10.634766 8.242188 C 9.873047 8.704428 9.222005 9.290365 8.681641 10 L 8.662109 10 C 8.011067 10 7.389323 9.868164 6.796875 9.604492 C 6.204427 9.34082 5.681966 8.984375 5.229492 8.535156 C 4.777018 8.085938 4.417317 7.565104 4.150391 6.972656 C 3.883463 6.380209 3.75 5.755209 3.75 5.097656 Z M 8.75 14.375 C 8.75 13.600261 8.898111 12.871094 9.194336 12.1875 C 9.49056 11.503906 9.892578 10.908203 10.400391 10.400391 C 10.908203 9.892578 11.503906 9.490561 12.1875 9.194336 C 12.871093 8.898112 13.60026 8.75 14.375 8.75 C 14.889322 8.75 15.385741 8.816732 15.864258 8.950195 C 16.342773 9.083659 16.790363 9.272461 17.207031 9.516602 C 17.623697 9.760742 18.004557 10.055339 18.349609 10.400391 C 18.69466 10.745443 18.989258 11.126303 19.233398 11.542969 C 19.477539 11.959636 19.66634 12.407227 19.799805 12.885742 C 19.933268 13.364258 20 13.860678 20 14.375 C 20 15.14974 19.851887 15.878906 19.555664 16.5625 C 19.259439 17.246094 18.857422 17.841797 18.349609 18.349609 C 17.841797 18.857422 17.246094 19.259439 16.5625 19.555664 C 15.878906 19.851889 15.149739 20 14.375 20 C 13.59375 20 12.861328 19.853516 12.177734 19.560547 C 11.494141 19.267578 10.898438 18.867188 10.390625 18.359375 C 9.882812 17.851562 9.482422 17.255859 9.189453 16.572266 C 8.896484 15.888672 8.75 15.15625 8.75 14.375 Z M 0 13.701172 C 0 13.375651 0.066732 13.064779 0.200195 12.768555 C 0.333659 12.472331 0.512695 12.211914 0.737305 11.987305 C 0.961914 11.762695 1.222331 11.583659 1.518555 11.450195 C 1.814779 11.316732 2.125651 11.25 2.451172 11.25 L 7.900391 11.25 C 7.809244 11.451823 7.722981 11.656901 7.641602 11.865234 C 7.560221 12.073568 7.490234 12.285156 7.431641 12.5 L 2.5 12.5 C 2.324219 12.5 2.161458 12.532553 2.011719 12.597656 C 1.861979 12.662761 1.730143 12.752279 1.616211 12.866211 C 1.502279 12.980144 1.41276 13.111979 1.347656 13.261719 C 1.282552 13.411459 1.25 13.574219 1.25 13.75 C 1.25 14.407553 1.359049 14.986979 1.577148 15.488281 C 1.795247 15.989584 2.091471 16.425781 2.46582 16.796875 C 2.840169 17.167969 3.273112 17.478842 3.764648 17.729492 C 4.256185 17.980143 4.777018 18.180338 5.327148 18.330078 C 5.877278 18.479818 6.438802 18.58724 7.011719 18.652344 C 7.584635 18.717447 8.138021 18.75 8.671875 18.75 C 8.847656 18.977865 9.033203 19.192709 9.228516 19.394531 C 9.423828 19.596354 9.635416 19.785156 9.863281 19.960938 C 9.674479 19.973959 9.488932 19.983725 9.306641 19.990234 C 9.124349 19.996744 8.938802 20 8.75 20 C 7.897135 20 7.042643 19.939779 6.186523 19.819336 C 5.330403 19.698893 4.511719 19.462891 3.730469 19.111328 C 3.157552 18.850912 2.641602 18.543295 2.182617 18.188477 C 1.723633 17.833658 1.333008 17.431641 1.010742 16.982422 C 0.688477 16.533203 0.439453 16.035156 0.263672 15.488281 C 0.087891 14.941406 0 14.345703 0 13.701172 Z M 15 15 L 16.875 15 C 17.04427 15 17.190754 14.938151 17.314453 14.814453 C 17.43815 14.690756 17.5 14.544271 17.5 14.375 C 17.5 14.205729 17.43815 14.059245 17.314453 13.935547 C 17.190754 13.81185 17.04427 13.75 16.875 13.75 L 15 13.75 L 15 11.875 C 14.999999 11.705729 14.93815 11.559245 14.814453 11.435547 C 14.690755 11.31185 14.544271 11.25 14.375 11.25 C 14.205729 11.25 14.059244 11.31185 13.935547 11.435547 C 13.811849 11.559245 13.75 11.705729 13.75 11.875 L 13.75 13.75 L 11.875 13.75 C 11.705729 13.75 11.559244 13.81185 11.435547 13.935547 C 11.311849 14.059245 11.25 14.205729 11.25 14.375 C 11.25 14.544271 11.311849 14.690756 11.435547 14.814453 C 11.559244 14.938151 11.705729 15 11.875 15 L 13.75 15 L 13.75 16.875 C 13.75 17.044271 13.811849 17.190756 13.935547 17.314453 C 14.059244 17.43815 14.205729 17.5 14.375 17.5 C 14.544271 17.5 14.690755 17.43815 14.814453 17.314453 C 14.93815 17.190756 14.999999 17.044271 15 16.875 Z " />
                                    </Viewbox>
                                    <TextBlock Text="Add Contact" />
                                </StackPanel>
                            </Button>
                        </Grid>

                        <AutoSuggestBox
                            Grid.Row="1"
                            Margin="0,6"
                            BorderThickness="0"
                            PlaceholderText="Search"
                            QueryIcon="Find" />

                        <!--  No contacts area  -->
                        <Grid
                            Grid.Row="2"
                            Margin="0,24,0,0"
                            Padding="12"
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            CornerRadius="8"
                            Visibility="{x:Bind ViewModel.HasNoContacts, Mode=OneWay}">
                            <StackPanel Orientation="Horizontal">
                                <Viewbox Width="20">
                                    <PathIcon Data="F1 M 3.056641 18.75 C 2.646484 18.75 2.255859 18.666992 1.884766 18.500977 C 1.513672 18.334961 1.189779 18.113607 0.913086 17.836914 C 0.636393 17.560221 0.415039 17.236328 0.249023 16.865234 C 0.083008 16.494141 0 16.103516 0 15.693359 L 0 4.306641 C 0 3.896484 0.083008 3.505859 0.249023 3.134766 C 0.415039 2.763672 0.636393 2.439779 0.913086 2.163086 C 1.189779 1.886395 1.513672 1.665039 1.884766 1.499023 C 2.255859 1.333008 2.646484 1.25 3.056641 1.25 L 6.875 1.25 C 7.376302 1.25 7.843424 1.359051 8.276367 1.577148 C 8.70931 1.795248 9.075521 2.102865 9.375 2.5 L 10.3125 3.75 L 16.875 3.75 C 17.239582 3.75 17.591145 3.813477 17.929688 3.94043 C 18.268229 4.067383 18.574219 4.241537 18.847656 4.462891 C 19.121094 4.684246 19.35384 4.947918 19.545898 5.253906 C 19.737955 5.559896 19.869791 5.891928 19.941406 6.25 L 18.642578 6.25 C 18.577473 6.061199 18.486328 5.890301 18.369141 5.737305 C 18.251953 5.584311 18.115234 5.452475 17.958984 5.341797 C 17.802734 5.231121 17.633463 5.146485 17.451172 5.087891 C 17.268879 5.029298 17.076822 5.000001 16.875 5 L 10.185547 5 C 9.951172 5.156251 9.728189 5.309246 9.516602 5.458984 C 9.305013 5.608725 9.086914 5.742188 8.862305 5.859375 C 8.637695 5.976562 8.404947 6.070964 8.164062 6.142578 C 7.923177 6.214193 7.65625 6.25 7.363281 6.25 L 1.25 6.25 L 1.25 15.625 C 1.25 15.878906 1.298828 16.119791 1.396484 16.347656 C 1.494141 16.575521 1.629232 16.775717 1.801758 16.948242 C 1.974284 17.120768 2.174479 17.255859 2.402344 17.353516 C 2.630208 17.451172 2.871094 17.5 3.125 17.5 L 8.613281 17.5 C 8.684896 17.721354 8.769531 17.936197 8.867188 18.144531 C 8.964844 18.352865 9.075521 18.554688 9.199219 18.75 Z M 7.363281 5 C 7.539062 5.000001 7.70345 4.977215 7.856445 4.931641 C 8.009439 4.886068 8.154297 4.825847 8.291016 4.750977 C 8.427734 4.676107 8.562825 4.5931 8.696289 4.501953 C 8.829752 4.410808 8.964844 4.316406 9.101562 4.21875 C 8.945312 4.010417 8.795572 3.803711 8.652344 3.598633 C 8.509114 3.393555 8.354492 3.209637 8.188477 3.046875 C 8.022461 2.884115 7.833658 2.752279 7.62207 2.651367 C 7.410481 2.550457 7.161458 2.5 6.875 2.5 L 3.125 2.5 C 2.871094 2.5 2.630208 2.548828 2.402344 2.646484 C 2.174479 2.744141 1.974284 2.879232 1.801758 3.051758 C 1.629232 3.224285 1.494141 3.42448 1.396484 3.652344 C 1.298828 3.880209 1.25 4.121094 1.25 4.375 L 1.25 5 Z M 11.865234 9.375 L 11.865234 9.306641 C 11.865234 8.883464 11.949869 8.486328 12.119141 8.115234 C 12.288411 7.744141 12.516275 7.420248 12.802734 7.143555 C 13.089192 6.866863 13.421224 6.648764 13.798828 6.489258 C 14.176432 6.329753 14.573567 6.25 14.990234 6.25 C 15.426432 6.25 15.833332 6.331381 16.210938 6.494141 C 16.588541 6.656901 16.918945 6.879883 17.202148 7.163086 C 17.485352 7.446289 17.708332 7.776693 17.871094 8.154297 C 18.033854 8.531901 18.115234 8.938803 18.115234 9.375 C 18.115234 9.811198 18.033854 10.2181 17.871094 10.595703 C 17.708332 10.973308 17.485352 11.303711 17.202148 11.586914 C 16.918945 11.870117 16.588541 12.0931 16.210938 12.255859 C 15.833332 12.41862 15.426432 12.5 14.990234 12.5 C 14.554036 12.5 14.147135 12.41862 13.769531 12.255859 C 13.391927 12.0931 13.061523 11.870117 12.77832 11.586914 C 12.495117 11.303711 12.272135 10.973308 12.109375 10.595703 C 11.946614 10.2181 11.865234 9.811198 11.865234 9.375 Z M 12.021484 13.75 L 17.958984 13.75 C 18.238932 13.75 18.500977 13.803711 18.745117 13.911133 C 18.989258 14.018555 19.204102 14.165039 19.389648 14.350586 C 19.575195 14.536133 19.72168 14.750977 19.829102 14.995117 C 19.936523 15.239258 19.990234 15.501303 19.990234 15.78125 L 19.990234 16.25 C 19.990234 16.653646 19.918619 17.026367 19.775391 17.368164 C 19.63216 17.709961 19.436848 18.019205 19.189453 18.295898 C 18.942057 18.572592 18.657227 18.818359 18.334961 19.033203 C 18.012695 19.248047 17.66927 19.427084 17.304688 19.570312 C 16.940104 19.713541 16.56901 19.820963 16.191406 19.892578 C 15.813802 19.964193 15.449219 20 15.097656 20 L 14.882812 20 C 14.544271 20 14.187825 19.964193 13.813477 19.892578 C 13.439127 19.820963 13.071289 19.71517 12.709961 19.575195 C 12.348633 19.435221 12.00358 19.261068 11.674805 19.052734 C 11.346028 18.8444 11.056314 18.603516 10.805664 18.330078 C 10.555013 18.056641 10.356445 17.752279 10.209961 17.416992 C 10.063477 17.081705 9.990234 16.71875 9.990234 16.328125 L 9.990234 15.78125 C 9.990234 15.501303 10.043945 15.239258 10.151367 14.995117 C 10.258789 14.750977 10.405273 14.536133 10.59082 14.350586 C 10.776367 14.165039 10.991211 14.018555 11.235352 13.911133 C 11.479492 13.803711 11.741536 13.75 12.021484 13.75 Z " />
                                </Viewbox>
                                <TextBlock
                                    Margin="24,0,0,0"
                                    VerticalAlignment="Center"
                                    FontWeight="SemiBold"
                                    Text="Your contact list is empty" />
                            </StackPanel>
                        </Grid>
                    </Grid>
                </ListView.Header>
                <ListView.ItemTemplate>
                    <DataTemplate x:DataType="data:ContactViewModel">
                        <Grid Padding="6,12" ColumnSpacing="12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <PersonPicture
                                Width="48"
                                DisplayName="{x:Bind ContactDisplayName, Mode=OneWay}"
                                Initials="{x:Bind Initials, Mode=OneWay}"
                                ProfilePicture="{x:Bind ProfileThumbnailUrl, Converter={StaticResource ProfileImageConverter}, Mode=OneWay}" />

                            <Grid Grid.Column="1" VerticalAlignment="Center">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <TextBlock
                                    FontSize="15"
                                    FontWeight="Bold"
                                    Style="{StaticResource BodyStrongTextBlockStyle}"
                                    Text="{x:Bind Profile.Name, Mode=OneWay}" />

                                <TextBlock Grid.Row="1" Text="{x:Bind Contact.Address}" />
                            </Grid>

                            <Border
                                Grid.Column="2"
                                Padding="6"
                                VerticalAlignment="Center"
                                Background="#1e76f2"
                                CornerRadius="6"
                                Visibility="{x:Bind helpers:XamlHelpers.ReverseBooleanToVisibility(Contact.IsRequestAcccepted), Mode=OneWay}">
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Text="Request" />
                            </Border>
                        </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>

                <ListView.GroupStyle>
                    <GroupStyle HeaderTemplateSelector="{StaticResource ContactRequestHeaderTemplateSelector}" HidesIfEmpty="True" />
                </ListView.GroupStyle>
            </ListView>
        </Grid>

        <controls:GridSplitter
            Grid.Column="1"
            Background="{ThemeResource AppBarSeparatorForegroundThemeBrush}"
            Opacity="0.2" />

        <ProgressRing
            Width="50"
            Height="50"
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            IsActive="{x:Bind ViewModel.IsLoading, Mode=OneWay}" />

        <!--  Right content  -->
        <Grid
            Grid.Column="2"
            RowSpacing="12"
            Visibility="{x:Bind ViewModel.HasSelectedContact, Mode=OneWay}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <CommandBar DefaultLabelPosition="Right">
                <CommandBar.PrimaryCommands>
                    <AppBarButton
                        Command="{x:Bind ViewModel.DeleteContactCommand}"
                        FlowDirection="LeftToRight"
                        Icon="Delete"
                        Label="Delete"
                        Visibility="{x:Bind ViewModel.IsInAddressBook, Mode=OneWay}" />
                    <AppBarButton
                        Command="{x:Bind ViewModel.RefreshContactCommand}"
                        FlowDirection="LeftToRight"
                        Icon="Refresh"
                        Label="Refresh" />
                    <AppBarButton
                        Command="{x:Bind ViewModel.FetchMessagesCommand}"
                        FlowDirection="LeftToRight"
                        Label="Fetch messages"
                        Visibility="{x:Bind ViewModel.IsInAddressBook, Mode=OneWay}">
                        <AppBarButton.Icon>
                            <PathIcon Data="F1 M 15.878906 3.330078 C 16.217447 3.330078 16.53483 3.398438 16.831055 3.535156 C 17.127277 3.671875 17.386066 3.854168 17.607422 4.082031 C 17.828775 4.309896 18.004557 4.575195 18.134766 4.87793 C 18.264973 5.180664 18.330078 5.498047 18.330078 5.830078 L 18.330078 14.169922 C 18.330078 14.501953 18.264973 14.819336 18.134766 15.12207 C 18.004557 15.424805 17.828775 15.690104 17.607422 15.917969 C 17.386066 16.145834 17.127277 16.328125 16.831055 16.464844 C 16.53483 16.601562 16.217447 16.669922 15.878906 16.669922 L 4.121094 16.669922 C 3.795573 16.669922 3.4847 16.603189 3.188477 16.469727 C 2.892252 16.336264 2.631836 16.157227 2.407227 15.932617 C 2.182617 15.708008 2.003581 15.447592 1.870117 15.151367 C 1.736654 14.855144 1.669922 14.544271 1.669922 14.21875 L 1.669922 5.78125 C 1.669922 5.45573 1.736654 5.144857 1.870117 4.848633 C 2.003581 4.552409 2.182617 4.291992 2.407227 4.067383 C 2.631836 3.842773 2.892252 3.663738 3.188477 3.530273 C 3.4847 3.396811 3.795573 3.330078 4.121094 3.330078 Z M 4.169922 5 C 4.052734 5.000001 3.943685 5.02116 3.842773 5.063477 C 3.741862 5.105795 3.653971 5.164389 3.579102 5.239258 C 3.504232 5.314129 3.44401 5.40202 3.398438 5.50293 C 3.352865 5.603842 3.330078 5.712891 3.330078 5.830078 L 3.330078 6.171875 L 9.609375 9.667969 C 9.720052 9.733073 9.85026 9.765625 10 9.765625 C 10.071614 9.765625 10.141602 9.757487 10.209961 9.741211 C 10.27832 9.724936 10.341797 9.700521 10.400391 9.667969 L 16.669922 6.181641 L 16.669922 5.830078 C 16.669922 5.712891 16.647135 5.603842 16.601562 5.50293 C 16.555988 5.40202 16.495768 5.314129 16.420898 5.239258 C 16.346027 5.164389 16.258137 5.105795 16.157227 5.063477 C 16.056314 5.02116 15.947266 5.000001 15.830078 5 Z M 15.830078 15 C 15.947266 15 16.056314 14.978842 16.157227 14.936523 C 16.258137 14.894206 16.346027 14.835612 16.420898 14.760742 C 16.495768 14.685873 16.555988 14.597982 16.601562 14.49707 C 16.647135 14.396159 16.669922 14.287109 16.669922 14.169922 L 16.669922 8.085938 L 11.201172 11.123047 C 10.836588 11.331381 10.436197 11.435547 10 11.435547 C 9.791666 11.435547 9.584961 11.411133 9.379883 11.362305 C 9.174805 11.313477 8.981119 11.236979 8.798828 11.132812 L 3.330078 8.076172 L 3.330078 14.169922 C 3.330078 14.287109 3.352865 14.396159 3.398438 14.49707 C 3.44401 14.597982 3.504232 14.685873 3.579102 14.760742 C 3.653971 14.835612 3.741862 14.894206 3.842773 14.936523 C 3.943685 14.978842 4.052734 15 4.169922 15 Z " />
                        </AppBarButton.Icon>
                    </AppBarButton>

                    <AppBarButton
                        Background="{ThemeResource SystemAccentColor}"
                        Command="{x:Bind ViewModel.CreateMessageCommand}"
                        Label="Write">
                        <AppBarButton.Icon>
                            <PathIcon Data="F1 M 0.625 17.5 C 0.455729 17.5 0.309245 17.43815 0.185547 17.314453 C 0.061849 17.190756 0 17.044271 0 16.875 C 0 16.829428 0.035807 16.689453 0.107422 16.455078 C 0.179036 16.220703 0.268555 15.9375 0.375977 15.605469 C 0.483398 15.273438 0.600586 14.916992 0.727539 14.536133 C 0.854492 14.155273 0.976562 13.79069 1.09375 13.442383 C 1.210938 13.094076 1.315104 12.788086 1.40625 12.524414 C 1.497396 12.260742 1.559245 12.083334 1.591797 11.992188 C 1.617839 11.907553 1.669922 11.826172 1.748047 11.748047 L 12.529297 0.966797 C 12.815755 0.68034 13.146158 0.458984 13.520508 0.302734 C 13.894856 0.146484 14.283854 0.068359 14.6875 0.068359 C 15.104166 0.068359 15.498047 0.148113 15.869141 0.307617 C 16.240234 0.467123 16.565754 0.68685 16.845703 0.966797 C 17.12565 1.246746 17.345377 1.572266 17.504883 1.943359 C 17.664387 2.314453 17.744141 2.708334 17.744141 3.125 C 17.744141 3.535156 17.666016 3.924154 17.509766 4.291992 C 17.353516 4.659831 17.13216 4.990234 16.845703 5.283203 L 15.263672 6.875 C 15.524088 7.161459 15.727539 7.444662 15.874023 7.724609 C 16.020508 8.004558 16.09375 8.346354 16.09375 8.75 C 16.09375 9.082031 16.030273 9.401042 15.90332 9.707031 C 15.776367 10.013021 15.595703 10.283203 15.361328 10.517578 L 13.564453 12.314453 C 13.440755 12.438151 13.294271 12.5 13.125 12.5 C 12.955729 12.5 12.809244 12.438151 12.685547 12.314453 C 12.561849 12.190756 12.5 12.044271 12.5 11.875 C 12.5 11.705729 12.561849 11.559245 12.685547 11.435547 L 14.482422 9.638672 C 14.729816 9.391276 14.853515 9.095053 14.853516 8.75 C 14.853515 8.548178 14.811197 8.365886 14.726562 8.203125 C 14.641927 8.040365 14.524739 7.893881 14.375 7.763672 L 6.064453 16.064453 C 5.979817 16.14909 5.885417 16.204428 5.78125 16.230469 L 0.78125 17.480469 C 0.716146 17.49349 0.664062 17.5 0.625 17.5 Z M 1.582031 15.996094 L 5.302734 15.058594 L 15.966797 4.404297 C 16.136066 4.235027 16.266275 4.039715 16.357422 3.818359 C 16.448566 3.597006 16.494141 3.365887 16.494141 3.125 C 16.494141 2.871094 16.446939 2.635092 16.352539 2.416992 C 16.258137 2.198895 16.129557 2.008465 15.966797 1.845703 C 15.804036 1.682943 15.613606 1.554363 15.395508 1.459961 C 15.177408 1.365561 14.941406 1.318359 14.6875 1.318359 C 14.446613 1.318359 14.215494 1.363934 13.994141 1.455078 C 13.772786 1.546225 13.577474 1.676434 13.408203 1.845703 L 2.734375 12.529297 Z M 1.523438 18.583984 L 3.203125 18.164062 C 3.580729 18.352865 3.972982 18.497721 4.379883 18.598633 C 4.786784 18.699545 5.201823 18.75 5.625 18.75 C 6.067708 18.75 6.500651 18.6556 6.923828 18.466797 C 7.347005 18.277994 7.762044 18.041992 8.168945 17.758789 C 8.575846 17.475586 8.976236 17.169596 9.370117 16.84082 C 9.763997 16.512045 10.151367 16.206055 10.532227 15.922852 C 10.913086 15.639648 11.287435 15.403646 11.655273 15.214844 C 12.023111 15.026042 12.386067 14.931641 12.744141 14.931641 C 12.952474 14.931641 13.144531 14.964193 13.320312 15.029297 C 13.59375 15.126953 13.818359 15.255534 13.994141 15.415039 C 14.169922 15.574545 14.316406 15.753581 14.433594 15.952148 C 14.550781 16.150717 14.650064 16.367188 14.731445 16.601562 C 14.812824 16.835938 14.892577 17.076824 14.970703 17.324219 C 15.003255 17.434896 15.0472 17.542318 15.102539 17.646484 C 15.157877 17.75065 15.224609 17.845053 15.302734 17.929688 C 15.341797 17.97526 15.388997 18.019205 15.444336 18.061523 C 15.499674 18.103842 15.559895 18.125 15.625 18.125 C 15.768229 18.125 15.939127 18.081055 16.137695 17.993164 C 16.336262 17.905273 16.536457 17.799479 16.738281 17.675781 C 16.940104 17.552084 17.133789 17.425131 17.319336 17.294922 C 17.504883 17.164713 17.659504 17.057291 17.783203 16.972656 C 17.978516 16.842449 18.185221 16.722006 18.40332 16.611328 C 18.621418 16.50065 18.8444 16.402994 19.072266 16.318359 C 19.182941 16.272787 19.283854 16.25 19.375 16.25 C 19.550781 16.25 19.698893 16.310223 19.819336 16.430664 C 19.939777 16.551107 20 16.699219 20 16.875 C 20 17.011719 19.957682 17.135416 19.873047 17.246094 C 19.78841 17.356771 19.680988 17.431641 19.550781 17.470703 C 19.54427 17.483725 19.524738 17.490234 19.492188 17.490234 C 19.186197 17.613932 18.873697 17.781576 18.554688 17.993164 C 18.235676 18.204752 17.91341 18.413086 17.587891 18.618164 C 17.262369 18.823242 16.935221 19.00065 16.606445 19.150391 C 16.277668 19.300131 15.95052 19.375 15.625 19.375 C 15.371094 19.375 15.139974 19.319662 14.931641 19.208984 C 14.723307 19.098307 14.534504 18.948568 14.365234 18.759766 C 14.215494 18.597006 14.09668 18.427734 14.008789 18.251953 C 13.920898 18.076172 13.8444 17.884115 13.779297 17.675781 C 13.740234 17.558594 13.694661 17.415365 13.642578 17.246094 C 13.590494 17.076822 13.523762 16.914062 13.442383 16.757812 C 13.361002 16.601562 13.263346 16.4681 13.149414 16.357422 C 13.03548 16.246746 12.90039 16.191406 12.744141 16.191406 C 12.496744 16.191406 12.223307 16.285809 11.923828 16.474609 C 11.624349 16.663412 11.298828 16.897787 10.947266 17.177734 C 10.595703 17.457682 10.218099 17.763672 9.814453 18.095703 C 9.410807 18.427734 8.986002 18.733725 8.540039 19.013672 C 8.094075 19.293619 7.626953 19.527994 7.138672 19.716797 C 6.650391 19.9056 6.145833 20 5.625 20 C 4.902344 20 4.192708 19.881186 3.496094 19.643555 C 2.799479 19.405924 2.161458 19.06901 1.582031 18.632812 Z " />
                        </AppBarButton.Icon>
                    </AppBarButton>
                </CommandBar.PrimaryCommands>
                <CommandBar.Content>
                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <AppBarButton
                            Command="{x:Bind ViewModel.AcceptRequestCommand}"
                            FlowDirection="LeftToRight"
                            Icon="Add"
                            Label="Add contact"
                            Visibility="{x:Bind ViewModel.IsNotInAddressBook, Mode=OneWay}" />

                        <StackPanel
                            Orientation="Horizontal"
                            Spacing="6"
                            Visibility="{x:Bind ViewModel.IsNotInAddressBook, Mode=OneWay}">
                            <TextBlock
                                VerticalAlignment="Center"
                                Foreground="#ff6229"
                                Text="Contact is not in your address book" />
                            <PathIcon
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Data="F1 M 3.75 4.902344 C 3.75 4.225262 3.885091 3.588867 4.155273 2.993164 C 4.425456 2.397461 4.790039 1.878256 5.249023 1.435547 C 5.708008 0.99284 6.238606 0.642904 6.84082 0.385742 C 7.443034 0.128582 8.079427 0 8.75 0 C 9.420572 0 10.056966 0.128582 10.65918 0.385742 C 11.261393 0.642904 11.791992 0.99284 12.250977 1.435547 C 12.709961 1.878256 13.074544 2.397461 13.344727 2.993164 C 13.614908 3.588867 13.75 4.225262 13.75 4.902344 C 13.75 5.332031 13.707682 5.740561 13.623047 6.12793 C 13.538411 6.5153 13.395182 6.901042 13.193359 7.285156 C 12.307942 7.434896 11.484375 7.734375 10.722656 8.183594 C 11.295572 7.819012 11.735025 7.353517 12.041016 6.787109 C 12.347005 6.220704 12.5 5.598959 12.5 4.921875 C 12.5 4.414062 12.399088 3.937176 12.197266 3.491211 C 11.995442 3.045248 11.722005 2.65625 11.376953 2.324219 C 11.0319 1.992188 10.633138 1.730145 10.180664 1.538086 C 9.728189 1.346029 9.251302 1.25 8.75 1.25 C 8.229166 1.25 7.740885 1.347656 7.285156 1.542969 C 6.829427 1.738281 6.432292 2.005209 6.09375 2.34375 C 5.755208 2.682293 5.488281 3.079428 5.292969 3.535156 C 5.097656 3.990887 5 4.479167 5 5 C 5 5.501303 5.096028 5.97819 5.288086 6.430664 C 5.480143 6.883139 5.742188 7.281902 6.074219 7.626953 C 6.40625 7.972006 6.795247 8.245443 7.241211 8.447266 C 7.687174 8.649089 8.164062 8.75 8.671875 8.75 C 9.029947 8.75 9.368489 8.710938 9.6875 8.632812 C 10.00651 8.554688 10.322266 8.424479 10.634766 8.242188 C 9.873047 8.704428 9.222005 9.290365 8.681641 10 L 8.662109 10 C 8.011067 10 7.389323 9.868164 6.796875 9.604492 C 6.204427 9.34082 5.681966 8.984375 5.229492 8.535156 C 4.777018 8.085938 4.417317 7.565104 4.150391 6.972656 C 3.883463 6.380209 3.75 5.755209 3.75 5.097656 Z M 8.75 14.375 C 8.75 13.600261 8.898111 12.871094 9.194336 12.1875 C 9.49056 11.503906 9.892578 10.908203 10.400391 10.400391 C 10.908203 9.892578 11.503906 9.490561 12.1875 9.194336 C 12.871093 8.898112 13.60026 8.75 14.375 8.75 C 14.889322 8.75 15.385741 8.816732 15.864258 8.950195 C 16.342773 9.083659 16.790363 9.272461 17.207031 9.516602 C 17.623697 9.760742 18.004557 10.055339 18.349609 10.400391 C 18.69466 10.745443 18.989258 11.126303 19.233398 11.542969 C 19.477539 11.959636 19.66634 12.407227 19.799805 12.885742 C 19.933268 13.364258 20 13.860678 20 14.375 C 20 15.14974 19.851887 15.878906 19.555664 16.5625 C 19.259439 17.246094 18.857422 17.841797 18.349609 18.349609 C 17.841797 18.857422 17.246094 19.259439 16.5625 19.555664 C 15.878906 19.851889 15.149739 20 14.375 20 C 13.59375 20 12.861328 19.853516 12.177734 19.560547 C 11.494141 19.267578 10.898438 18.867188 10.390625 18.359375 C 9.882812 17.851562 9.482422 17.255859 9.189453 16.572266 C 8.896484 15.888672 8.75 15.15625 8.75 14.375 Z M 0 13.701172 C 0 13.375651 0.066732 13.064779 0.200195 12.768555 C 0.333659 12.472331 0.512695 12.211914 0.737305 11.987305 C 0.961914 11.762695 1.222331 11.583659 1.518555 11.450195 C 1.814779 11.316732 2.125651 11.25 2.451172 11.25 L 7.900391 11.25 C 7.809244 11.451823 7.722981 11.656901 7.641602 11.865234 C 7.560221 12.073568 7.490234 12.285156 7.431641 12.5 L 2.5 12.5 C 2.324219 12.5 2.161458 12.532553 2.011719 12.597656 C 1.861979 12.662761 1.730143 12.752279 1.616211 12.866211 C 1.502279 12.980144 1.41276 13.111979 1.347656 13.261719 C 1.282552 13.411459 1.25 13.574219 1.25 13.75 C 1.25 14.407553 1.359049 14.986979 1.577148 15.488281 C 1.795247 15.989584 2.091471 16.425781 2.46582 16.796875 C 2.840169 17.167969 3.273112 17.478842 3.764648 17.729492 C 4.256185 17.980143 4.777018 18.180338 5.327148 18.330078 C 5.877278 18.479818 6.438802 18.58724 7.011719 18.652344 C 7.584635 18.717447 8.138021 18.75 8.671875 18.75 C 8.847656 18.977865 9.033203 19.192709 9.228516 19.394531 C 9.423828 19.596354 9.635416 19.785156 9.863281 19.960938 C 9.674479 19.973959 9.488932 19.983725 9.306641 19.990234 C 9.124349 19.996744 8.938802 20 8.75 20 C 8.333333 20 7.908528 19.986979 7.475586 19.960938 C 7.042643 19.934896 6.612955 19.887695 6.186523 19.819336 C 5.760091 19.750977 5.340169 19.65983 4.926758 19.545898 C 4.513346 19.431967 4.114583 19.287109 3.730469 19.111328 C 3.157552 18.850912 2.641602 18.543295 2.182617 18.188477 C 1.723633 17.833658 1.333008 17.431641 1.010742 16.982422 C 0.688477 16.533203 0.439453 16.035156 0.263672 15.488281 C 0.087891 14.941406 0 14.345703 0 13.701172 Z M 14.375 15.253906 L 16.123047 17.001953 C 16.246744 17.12565 16.393229 17.1875 16.5625 17.1875 C 16.73177 17.1875 16.878254 17.12565 17.001953 17.001953 C 17.12565 16.878256 17.1875 16.731771 17.1875 16.5625 C 17.1875 16.39323 17.12565 16.246746 17.001953 16.123047 L 15.263672 14.375 L 17.001953 12.626953 C 17.12565 12.503256 17.1875 12.356771 17.1875 12.1875 C 17.1875 12.018229 17.12565 11.871745 17.001953 11.748047 C 16.878254 11.62435 16.73177 11.5625 16.5625 11.5625 C 16.393229 11.5625 16.246744 11.62435 16.123047 11.748047 L 14.375 13.486328 L 12.626953 11.748047 C 12.503255 11.62435 12.356771 11.5625 12.1875 11.5625 C 12.018229 11.5625 11.871744 11.62435 11.748047 11.748047 C 11.624349 11.871745 11.5625 12.018229 11.5625 12.1875 C 11.5625 12.356771 11.624349 12.503256 11.748047 12.626953 L 13.496094 14.375 L 11.748047 16.123047 C 11.624349 16.246746 11.5625 16.39323 11.5625 16.5625 C 11.5625 16.731771 11.624349 16.878256 11.748047 17.001953 C 11.871744 17.12565 12.018229 17.1875 12.1875 17.1875 C 12.356771 17.1875 12.503255 17.12565 12.626953 17.001953 Z "
                                Foreground="#ff6229" />
                        </StackPanel>
                    </StackPanel>
                </CommandBar.Content>
            </CommandBar>
            <controls1:ContactProfileControl
                Grid.Row="1"
                BroadcastStateChangedCommand="{x:Bind ViewModel.BroadcastStateChangedCommand}"
                Contact="{x:Bind ViewModel.SelectedContactViewModel, Mode=OneWay}"
                Visibility="Collapsed" />
        </Grid>
    </Grid>
</local:ContactsPageAbstract>


