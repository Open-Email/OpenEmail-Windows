<?xml version="1.0" encoding="utf-8" ?>
<local:ShellPageAbstract
    x:Class="OpenEmail.Views.ShellPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:animatedvisuals="using:Microsoft.UI.Xaml.Controls.AnimatedVisuals"
    xmlns:animations="using:CommunityToolkit.WinUI.Animations"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:controls1="using:OpenEmail.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:OpenEmail.Views"
    xmlns:mail="using:OpenEmail.Domain.Models.Mail"
    xmlns:main="using:OpenEmail"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:media="using:CommunityToolkit.WinUI.Media"
    xmlns:messages="using:OpenEmail.Domain.Models.Messages"
    xmlns:navigation="using:OpenEmail.Domain.Models.Navigation"
    xmlns:selectors="using:OpenEmail.Selectors"
    xmlns:tb="using:H.NotifyIcon"
    xmlns:ui="using:CommunityToolkit.WinUI"
    IsDisplayingProfileControl="{x:Bind ViewModel.IsProfileLoadMenuVisible, Mode=OneWay}"
    mc:Ignorable="d">

    <Page.Resources>
        <media:AttachedCardShadow
            x:Key="CommonShadow"
            CornerRadius="4"
            Offset="2" />

        <DataTemplate x:Key="UploadingMessageUploadProgressTemplate" x:DataType="messages:MessageUploadProgress">
            <Grid ColumnSpacing="6">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <TextBlock Text="{x:Bind UploadTitle}" TextWrapping="Wrap" />

                <ProgressRing
                    Grid.Column="1"
                    Width="10"
                    Height="10"
                    VerticalAlignment="Top" />

                <ProgressBar
                    Grid.Row="1"
                    Grid.ColumnSpan="2"
                    Margin="0,6"
                    HorizontalAlignment="Stretch"
                    Visibility="{x:Bind IsProgressAvailable, Mode=OneWay}"
                    Value="{x:Bind Progress, Mode=OneWay}" />
            </Grid>
        </DataTemplate>

        <DataTemplate x:Key="FailedMessageUploadProgressTemplate" x:DataType="messages:MessageUploadProgress">
            <Grid ColumnSpacing="6">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBlock Text="{x:Bind UploadTitle}" TextWrapping="Wrap" />

                <PathIcon
                    Grid.Column="1"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Data="F1 M 18.75 9.375 C 18.75 10.240886 18.639322 11.072592 18.417969 11.870117 C 18.196613 12.667644 17.882486 13.414714 17.475586 14.111328 C 17.068684 14.807943 16.580402 15.441081 16.010742 16.010742 C 15.44108 16.580404 14.807942 17.068686 14.111328 17.475586 C 13.414713 17.882486 12.667643 18.196615 11.870117 18.417969 C 11.072591 18.639322 10.240885 18.75 9.375 18.75 C 8.509114 18.75 7.675781 18.639322 6.875 18.417969 C 6.074219 18.196615 5.327148 17.882486 4.633789 17.475586 C 3.94043 17.068686 3.308919 16.580404 2.739258 16.010742 C 2.169596 15.441081 1.681315 14.80957 1.274414 14.116211 C 0.867513 13.422852 0.553385 12.675781 0.332031 11.875 C 0.110677 11.074219 0 10.240886 0 9.375 C 0 8.509115 0.110677 7.677409 0.332031 6.879883 C 0.553385 6.082357 0.867513 5.335287 1.274414 4.638672 C 1.681315 3.942059 2.169596 3.30892 2.739258 2.739258 C 3.308919 2.169598 3.942057 1.681316 4.638672 1.274414 C 5.335286 0.867514 6.082356 0.553387 6.879883 0.332031 C 7.677409 0.110678 8.509114 0 9.375 0 C 10.234375 0 11.062825 0.112305 11.860352 0.336914 C 12.657877 0.561523 13.404947 0.877279 14.101562 1.28418 C 14.798176 1.691082 15.431314 2.179363 16.000977 2.749023 C 16.570637 3.318686 17.058918 3.951824 17.46582 4.648438 C 17.872721 5.345053 18.188477 6.092123 18.413086 6.889648 C 18.637695 7.687175 18.75 8.515625 18.75 9.375 Z M 17.5 9.375 C 17.5 8.626303 17.403971 7.905273 17.211914 7.211914 C 17.019855 6.518556 16.746418 5.87077 16.391602 5.268555 C 16.036783 4.666342 15.613606 4.119467 15.12207 3.62793 C 14.630533 3.136395 14.083658 2.713217 13.481445 2.358398 C 12.879231 2.003582 12.231445 1.730145 11.538086 1.538086 C 10.844727 1.346029 10.123697 1.25 9.375 1.25 C 8.626302 1.25 7.905273 1.346029 7.211914 1.538086 C 6.518555 1.730145 5.870768 2.003582 5.268555 2.358398 C 4.666341 2.713217 4.119466 3.136395 3.62793 3.62793 C 3.136393 4.119467 2.713216 4.666342 2.358398 5.268555 C 2.003581 5.87077 1.730143 6.518556 1.538086 7.211914 C 1.346029 7.905273 1.25 8.626303 1.25 9.375 C 1.25 10.123698 1.346029 10.844727 1.538086 11.538086 C 1.730143 12.231445 2.001953 12.879232 2.353516 13.481445 C 2.705078 14.083659 3.128255 14.632162 3.623047 15.126953 C 4.117838 15.621745 4.666341 16.044922 5.268555 16.396484 C 5.870768 16.748047 6.518555 17.019857 7.211914 17.211914 C 7.905273 17.403971 8.626302 17.5 9.375 17.5 C 10.123697 17.5 10.844727 17.403971 11.538086 17.211914 C 12.231445 17.019857 12.879231 16.74642 13.481445 16.391602 C 14.083658 16.036783 14.630533 15.613607 15.12207 15.12207 C 15.613606 14.630534 16.036783 14.083659 16.391602 13.481445 C 16.746418 12.879232 17.019855 12.231445 17.211914 11.538086 C 17.403971 10.844727 17.5 10.123698 17.5 9.375 Z M 13.4375 5.9375 C 13.4375 6.106771 13.37565 6.253256 13.251953 6.376953 L 10.253906 9.375 L 13.251953 12.373047 C 13.37565 12.496745 13.4375 12.643229 13.4375 12.8125 C 13.4375 12.981771 13.37565 13.128256 13.251953 13.251953 C 13.128254 13.375651 12.98177 13.4375 12.8125 13.4375 C 12.643229 13.4375 12.496744 13.375651 12.373047 13.251953 L 9.375 10.253906 L 6.376953 13.251953 C 6.253255 13.375651 6.106771 13.4375 5.9375 13.4375 C 5.768229 13.4375 5.621745 13.375651 5.498047 13.251953 C 5.374349 13.128256 5.3125 12.981771 5.3125 12.8125 C 5.3125 12.643229 5.374349 12.496745 5.498047 12.373047 L 8.496094 9.375 L 5.498047 6.376953 C 5.374349 6.253256 5.3125 6.106771 5.3125 5.9375 C 5.3125 5.768229 5.374349 5.621745 5.498047 5.498047 C 5.621745 5.37435 5.768229 5.3125 5.9375 5.3125 C 6.106771 5.3125 6.253255 5.37435 6.376953 5.498047 L 9.375 8.496094 L 12.373047 5.498047 C 12.496744 5.37435 12.643229 5.3125 12.8125 5.3125 C 12.98177 5.3125 13.128254 5.37435 13.251953 5.498047 C 13.37565 5.621745 13.4375 5.768229 13.4375 5.9375 Z " />
            </Grid>
        </DataTemplate>

        <DataTemplate x:Key="CompletedMessageUploadProgressTemplate" x:DataType="messages:MessageUploadProgress">
            <Grid ColumnSpacing="6">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBlock Text="{x:Bind UploadTitle}" TextWrapping="Wrap" />
                <PathIcon
                    Grid.Column="1"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Data="F1 M 2.451172 20 C 2.125651 20 1.814779 19.933268 1.518555 19.799805 C 1.222331 19.666342 0.961914 19.487305 0.737305 19.262695 C 0.512695 19.038086 0.333659 18.77767 0.200195 18.481445 C 0.066732 18.185221 0 17.87435 0 17.548828 L 0 2.451172 C 0 2.125652 0.066732 1.814779 0.200195 1.518555 C 0.333659 1.222332 0.512695 0.961914 0.737305 0.737305 C 0.961914 0.512695 1.222331 0.33366 1.518555 0.200195 C 1.814779 0.066732 2.125651 0 2.451172 0 L 17.548828 0 C 17.874348 0 18.185221 0.066732 18.481445 0.200195 C 18.777668 0.33366 19.038086 0.512695 19.262695 0.737305 C 19.487305 0.961914 19.66634 1.222332 19.799805 1.518555 C 19.933268 1.814779 20 2.125652 20 2.451172 L 20 17.548828 C 20 17.87435 19.933268 18.185221 19.799805 18.481445 C 19.66634 18.77767 19.487305 19.038086 19.262695 19.262695 C 19.038086 19.487305 18.777668 19.666342 18.481445 19.799805 C 18.185221 19.933268 17.874348 20 17.548828 20 Z M 17.5 18.75 C 17.675781 18.75 17.838541 18.717447 17.988281 18.652344 C 18.13802 18.58724 18.269855 18.497721 18.383789 18.383789 C 18.497721 18.269857 18.587238 18.138021 18.652344 17.988281 C 18.717447 17.838541 18.75 17.675781 18.75 17.5 L 18.75 2.5 C 18.75 2.33073 18.717447 2.169598 18.652344 2.016602 C 18.587238 1.863607 18.497721 1.730145 18.383789 1.616211 C 18.269855 1.502279 18.136393 1.412762 17.983398 1.347656 C 17.830402 1.282553 17.66927 1.25 17.5 1.25 L 2.5 1.25 C 2.324219 1.25 2.161458 1.282553 2.011719 1.347656 C 1.861979 1.412762 1.730143 1.502279 1.616211 1.616211 C 1.502279 1.730145 1.41276 1.86198 1.347656 2.011719 C 1.282552 2.161459 1.25 2.324219 1.25 2.5 L 1.25 17.5 C 1.25 17.675781 1.282552 17.84017 1.347656 17.993164 C 1.41276 18.146158 1.500651 18.277994 1.611328 18.388672 C 1.722005 18.49935 1.853841 18.58724 2.006836 18.652344 C 2.159831 18.717447 2.324219 18.75 2.5 18.75 Z M 3.75 9.375 C 3.75 9.205729 3.811849 9.059245 3.935547 8.935547 C 4.059245 8.81185 4.205729 8.75 4.375 8.75 C 4.544271 8.75 4.690755 8.81185 4.814453 8.935547 L 8.125 12.236328 L 15.185547 5.185547 C 15.309244 5.06185 15.455729 5.000001 15.625 5 C 15.79427 5.000001 15.940754 5.06185 16.064453 5.185547 C 16.18815 5.309245 16.25 5.455729 16.25 5.625 C 16.25 5.794271 16.18815 5.940756 16.064453 6.064453 L 8.564453 13.564453 C 8.440755 13.688151 8.294271 13.75 8.125 13.75 C 7.955729 13.75 7.809245 13.688151 7.685547 13.564453 L 3.935547 9.814453 C 3.811849 9.690756 3.75 9.544271 3.75 9.375 Z "
                    Foreground="Lime" />
            </Grid>
        </DataTemplate>

        <selectors:MessageUploadProgressTemplateSelector
            x:Key="MessageUploadProgressTemplateSelector"
            Completed="{StaticResource CompletedMessageUploadProgressTemplate}"
            Failed="{StaticResource FailedMessageUploadProgressTemplate}"
            Uploading="{StaticResource UploadingMessageUploadProgressTemplate}" />
    </Page.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!--  Title Bar  -->
        <TitleBar
            Grid.ColumnSpan="3"
            VerticalContentAlignment="Center"
            Background="{ThemeResource TitleBarBackgroundBrush}"
            IsPaneToggleButtonVisible="False"
            PaneToggleRequested="PaneButtonClicked">
            <TitleBar.Header>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Button
                        x:Name="PaneButton"
                        Width="48"
                        Margin="-1"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch"
                        Background="Transparent"
                        BorderThickness="0"
                        Click="NavigationPaneButtonClicked"
                        RequestedTheme="Dark">
                        <AnimatedIcon x:Name="SearchAnimatedIcon" Width="16">
                            <AnimatedIcon.Source>
                                <animatedvisuals:AnimatedGlobalNavigationButtonVisualSource />
                            </AnimatedIcon.Source>
                            <AnimatedIcon.FallbackIconSource>
                                <SymbolIconSource Symbol="Find" />
                            </AnimatedIcon.FallbackIconSource>
                        </AnimatedIcon>
                    </Button>

                    <Image
                        x:Name="TitleBarLogoImage"
                        Grid.Column="1"
                        Height="20"
                        Margin="4,0"
                        VerticalAlignment="Center"
                        Source="{ThemeResource LogoImageSource}" />
                </Grid>
            </TitleBar.Header>
            <TitleBar.Footer>
                <StackPanel
                    VerticalAlignment="Center"
                    Orientation="Horizontal"
                    Spacing="6">
                    <SplitButton
                        x:Name="NewMessageButton"
                        Margin="0,4"
                        Padding="20,0"
                        VerticalAlignment="Stretch"
                        HorizontalContentAlignment="Stretch"
                        BorderThickness="0"
                        Command="{x:Bind ViewModel.NewMessageCommand}">
                        <SplitButton.Flyout>
                            <MenuFlyout>
                                <MenuFlyoutItem Command="{x:Bind ViewModel.NewBroadcastCommand}" Text="Broadcast">
                                    <MenuFlyoutItem.Icon>
                                        <FontIcon FontFamily="{StaticResource OpenEmailIconFontFamily}" Glyph="{x:Bind main:OpenEmailIcons.Broadcast}" />
                                    </MenuFlyoutItem.Icon>
                                </MenuFlyoutItem>
                            </MenuFlyout>
                        </SplitButton.Flyout>

                        <StackPanel
                            HorizontalAlignment="Center"
                            Orientation="Horizontal"
                            Spacing="12">
                            <PathIcon
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Data="F1 M 0.625 17.5 C 0.455729 17.5 0.309245 17.43815 0.185547 17.314453 C 0.061849 17.190756 0 17.044271 0 16.875 C 0 16.829428 0.035807 16.689453 0.107422 16.455078 C 0.179036 16.220703 0.268555 15.9375 0.375977 15.605469 C 0.483398 15.273438 0.600586 14.916992 0.727539 14.536133 C 0.854492 14.155273 0.976562 13.79069 1.09375 13.442383 C 1.210938 13.094076 1.315104 12.788086 1.40625 12.524414 C 1.497396 12.260742 1.559245 12.083334 1.591797 11.992188 C 1.617839 11.907553 1.669922 11.826172 1.748047 11.748047 L 12.529297 0.966797 C 12.815755 0.68034 13.146158 0.458984 13.520508 0.302734 C 13.894856 0.146484 14.283854 0.068359 14.6875 0.068359 C 15.104166 0.068359 15.498047 0.148113 15.869141 0.307617 C 16.240234 0.467123 16.565754 0.68685 16.845703 0.966797 C 17.12565 1.246746 17.345377 1.572266 17.504883 1.943359 C 17.664387 2.314453 17.744141 2.708334 17.744141 3.125 C 17.744141 3.535156 17.666016 3.924154 17.509766 4.291992 C 17.353516 4.659831 17.13216 4.990234 16.845703 5.283203 L 15.263672 6.875 C 15.524088 7.161459 15.727539 7.444662 15.874023 7.724609 C 16.020508 8.004558 16.09375 8.346354 16.09375 8.75 C 16.09375 9.082031 16.030273 9.401042 15.90332 9.707031 C 15.776367 10.013021 15.595703 10.283203 15.361328 10.517578 L 13.564453 12.314453 C 13.440755 12.438151 13.294271 12.5 13.125 12.5 C 12.955729 12.5 12.809244 12.438151 12.685547 12.314453 C 12.561849 12.190756 12.5 12.044271 12.5 11.875 C 12.5 11.705729 12.561849 11.559245 12.685547 11.435547 L 14.482422 9.638672 C 14.729816 9.391276 14.853515 9.095053 14.853516 8.75 C 14.853515 8.548178 14.811197 8.365886 14.726562 8.203125 C 14.641927 8.040365 14.524739 7.893881 14.375 7.763672 L 6.064453 16.064453 C 5.979817 16.14909 5.885417 16.204428 5.78125 16.230469 L 0.78125 17.480469 C 0.716146 17.49349 0.664062 17.5 0.625 17.5 Z M 1.582031 15.996094 L 5.302734 15.058594 L 15.966797 4.404297 C 16.136066 4.235027 16.266275 4.039715 16.357422 3.818359 C 16.448566 3.597006 16.494141 3.365887 16.494141 3.125 C 16.494141 2.871094 16.446939 2.635092 16.352539 2.416992 C 16.258137 2.198895 16.129557 2.008465 15.966797 1.845703 C 15.804036 1.682943 15.613606 1.554363 15.395508 1.459961 C 15.177408 1.365561 14.941406 1.318359 14.6875 1.318359 C 14.446613 1.318359 14.215494 1.363934 13.994141 1.455078 C 13.772786 1.546225 13.577474 1.676434 13.408203 1.845703 L 2.734375 12.529297 Z M 1.523438 18.583984 L 3.203125 18.164062 C 3.580729 18.352865 3.972982 18.497721 4.379883 18.598633 C 4.786784 18.699545 5.201823 18.75 5.625 18.75 C 6.067708 18.75 6.500651 18.6556 6.923828 18.466797 C 7.347005 18.277994 7.762044 18.041992 8.168945 17.758789 C 8.575846 17.475586 8.976236 17.169596 9.370117 16.84082 C 9.763997 16.512045 10.151367 16.206055 10.532227 15.922852 C 10.913086 15.639648 11.287435 15.403646 11.655273 15.214844 C 12.023111 15.026042 12.386067 14.931641 12.744141 14.931641 C 12.952474 14.931641 13.144531 14.964193 13.320312 15.029297 C 13.59375 15.126953 13.818359 15.255534 13.994141 15.415039 C 14.169922 15.574545 14.316406 15.753581 14.433594 15.952148 C 14.550781 16.150717 14.650064 16.367188 14.731445 16.601562 C 14.812824 16.835938 14.892577 17.076824 14.970703 17.324219 C 15.003255 17.434896 15.0472 17.542318 15.102539 17.646484 C 15.157877 17.75065 15.224609 17.845053 15.302734 17.929688 C 15.341797 17.97526 15.388997 18.019205 15.444336 18.061523 C 15.499674 18.103842 15.559895 18.125 15.625 18.125 C 15.768229 18.125 15.939127 18.081055 16.137695 17.993164 C 16.336262 17.905273 16.536457 17.799479 16.738281 17.675781 C 16.940104 17.552084 17.133789 17.425131 17.319336 17.294922 C 17.504883 17.164713 17.659504 17.057291 17.783203 16.972656 C 17.978516 16.842449 18.185221 16.722006 18.40332 16.611328 C 18.621418 16.50065 18.8444 16.402994 19.072266 16.318359 C 19.182941 16.272787 19.283854 16.25 19.375 16.25 C 19.550781 16.25 19.698893 16.310223 19.819336 16.430664 C 19.939777 16.551107 20 16.699219 20 16.875 C 20 17.011719 19.957682 17.135416 19.873047 17.246094 C 19.78841 17.356771 19.680988 17.431641 19.550781 17.470703 C 19.54427 17.483725 19.524738 17.490234 19.492188 17.490234 C 19.186197 17.613932 18.873697 17.781576 18.554688 17.993164 C 18.235676 18.204752 17.91341 18.413086 17.587891 18.618164 C 17.262369 18.823242 16.935221 19.00065 16.606445 19.150391 C 16.277668 19.300131 15.95052 19.375 15.625 19.375 C 15.371094 19.375 15.139974 19.319662 14.931641 19.208984 C 14.723307 19.098307 14.534504 18.948568 14.365234 18.759766 C 14.215494 18.597006 14.09668 18.427734 14.008789 18.251953 C 13.920898 18.076172 13.8444 17.884115 13.779297 17.675781 C 13.740234 17.558594 13.694661 17.415365 13.642578 17.246094 C 13.590494 17.076822 13.523762 16.914062 13.442383 16.757812 C 13.361002 16.601562 13.263346 16.4681 13.149414 16.357422 C 13.03548 16.246746 12.90039 16.191406 12.744141 16.191406 C 12.496744 16.191406 12.223307 16.285809 11.923828 16.474609 C 11.624349 16.663412 11.298828 16.897787 10.947266 17.177734 C 10.595703 17.457682 10.218099 17.763672 9.814453 18.095703 C 9.410807 18.427734 8.986002 18.733725 8.540039 19.013672 C 8.094075 19.293619 7.626953 19.527994 7.138672 19.716797 C 6.650391 19.9056 6.145833 20 5.625 20 C 4.902344 20 4.192708 19.881186 3.496094 19.643555 C 2.799479 19.405924 2.161458 19.06901 1.582031 18.632812 Z " />
                            <TextBlock x:Name="NewMessageTextBlock" Text="New Mail" />
                        </StackPanel>
                    </SplitButton>

                    <Button
                        x:Name="SynchronizeButton"
                        Grid.Column="1"
                        Margin="0,4"
                        Padding="20,0"
                        VerticalAlignment="Stretch"
                        HorizontalContentAlignment="Stretch"
                        BorderThickness="0"
                        Command="{x:Bind ViewModel.SynchronizeCommand}">
                        <StackPanel
                            HorizontalAlignment="Stretch"
                            Orientation="Horizontal"
                            Spacing="12">

                            <FontIcon
                                FontFamily="{StaticResource OpenEmailIconFontFamily}"
                                FontSize="18"
                                Glyph="{x:Bind main:OpenEmailIcons.Sync}" />
                            <TextBlock x:Name="NextSynchronizationTextBlock" Text="{x:Bind ViewModel.SynchronizationButtonText, Mode=OneWay}" />

                            <ProgressRing
                                Grid.Column="2"
                                Width="16"
                                Height="16"
                                VerticalAlignment="Center"
                                Visibility="{x:Bind ViewModel.SynchronizeCommand.IsRunning, Mode=OneWay}" />
                        </StackPanel>
                    </Button>

                    <Button
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch"
                        Style="{StaticResource TransparentButtonStyle}"
                        Visibility="{x:Bind ViewModel.HasOngoingUploads, Mode=OneWay}">
                        <Button.Flyout>
                            <Flyout Placement="Bottom">
                                <Grid Width="300" RowSpacing="12">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" MaxHeight="400" />
                                    </Grid.RowDefinitions>

                                    <TextBlock FontWeight="SemiBold" Text="Upload Queue" />
                                    <Border
                                        Grid.Row="1"
                                        Height="2"
                                        HorizontalAlignment="Stretch"
                                        Background="{ThemeResource GeneralSeperatorBrush}" />

                                    <ListView
                                        Grid.Row="2"
                                        ItemTemplateSelector="{StaticResource MessageUploadProgressTemplateSelector}"
                                        ItemsSource="{x:Bind ViewModel.MessageUploader.MessageUploadQueue}"
                                        SelectionMode="None" />
                                </Grid>
                            </Flyout>
                        </Button.Flyout>
                        <PathIcon
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Data="F1 M 8.125 16.25 C 7.871094 16.25 7.630208 16.201172 7.402344 16.103516 C 7.174479 16.005859 6.974283 15.870769 6.801758 15.698242 C 6.629231 15.525717 6.494141 15.325521 6.396484 15.097656 C 6.298828 14.869792 6.25 14.628906 6.25 14.375 L 6.25 5.625 C 6.25 5.371094 6.298828 5.130209 6.396484 4.902344 C 6.494141 4.67448 6.629231 4.474285 6.801758 4.301758 C 6.974283 4.129232 7.174479 3.994141 7.402344 3.896484 C 7.630208 3.798828 7.871094 3.75 8.125 3.75 L 18.125 3.75 C 18.378906 3.75 18.619791 3.798828 18.847656 3.896484 C 19.07552 3.994141 19.275715 4.129232 19.448242 4.301758 C 19.620768 4.474285 19.755859 4.67448 19.853516 4.902344 C 19.951172 5.130209 20 5.371094 20 5.625 L 20 14.375 C 20 14.628906 19.951172 14.869792 19.853516 15.097656 C 19.755859 15.325521 19.620768 15.525717 19.448242 15.698242 C 19.275715 15.870769 19.07552 16.005859 18.847656 16.103516 C 18.619791 16.201172 18.378906 16.25 18.125 16.25 Z M 18.125 15 C 18.29427 15 18.440754 14.938151 18.564453 14.814453 C 18.68815 14.690756 18.75 14.544271 18.75 14.375 L 18.75 5.625 C 18.75 5.455729 18.68815 5.309245 18.564453 5.185547 C 18.440754 5.06185 18.29427 5.000001 18.125 5 L 8.125 5 C 7.955729 5.000001 7.809245 5.06185 7.685547 5.185547 C 7.561849 5.309245 7.5 5.455729 7.5 5.625 L 7.5 14.375 C 7.5 14.544271 7.561849 14.690756 7.685547 14.814453 C 7.809245 14.938151 7.955729 15 8.125 15 Z M 0.625 7.5 C 0.455729 7.5 0.309245 7.438151 0.185547 7.314453 C 0.061849 7.190756 0 7.044271 0 6.875 C 0 6.705729 0.061849 6.559245 0.185547 6.435547 C 0.309245 6.31185 0.455729 6.25 0.625 6.25 L 4.375 6.25 C 4.544271 6.25 4.690755 6.31185 4.814453 6.435547 C 4.938151 6.559245 5 6.705729 5 6.875 C 5 7.044271 4.938151 7.190756 4.814453 7.314453 C 4.690755 7.438151 4.544271 7.5 4.375 7.5 Z M 9.375 7.5 C 9.205729 7.5 9.059244 7.438151 8.935547 7.314453 C 8.811849 7.190756 8.75 7.044271 8.75 6.875 C 8.75 6.705729 8.811849 6.559245 8.935547 6.435547 C 9.059244 6.31185 9.205729 6.25 9.375 6.25 L 16.875 6.25 C 17.04427 6.25 17.190754 6.31185 17.314453 6.435547 C 17.43815 6.559245 17.5 6.705729 17.5 6.875 C 17.5 7.044271 17.43815 7.190756 17.314453 7.314453 C 17.190754 7.438151 17.04427 7.5 16.875 7.5 Z M 1.875 10 C 1.705729 10 1.559245 9.938151 1.435547 9.814453 C 1.311849 9.690756 1.25 9.544271 1.25 9.375 C 1.25 9.205729 1.311849 9.059245 1.435547 8.935547 C 1.559245 8.81185 1.705729 8.75 1.875 8.75 L 4.375 8.75 C 4.544271 8.75 4.690755 8.81185 4.814453 8.935547 C 4.938151 9.059245 5 9.205729 5 9.375 C 5 9.544271 4.938151 9.690756 4.814453 9.814453 C 4.690755 9.938151 4.544271 10 4.375 10 Z M 9.375 10 C 9.205729 10 9.059244 9.938151 8.935547 9.814453 C 8.811849 9.690756 8.75 9.544271 8.75 9.375 C 8.75 9.205729 8.811849 9.059245 8.935547 8.935547 C 9.059244 8.81185 9.205729 8.75 9.375 8.75 L 10.625 8.75 C 10.794271 8.75 10.940755 8.81185 11.064453 8.935547 C 11.18815 9.059245 11.25 9.205729 11.25 9.375 C 11.25 9.544271 11.18815 9.690756 11.064453 9.814453 C 10.940755 9.938151 10.794271 10 10.625 10 Z M 13.75 13.75 C 13.574219 13.75 13.40983 13.717448 13.256836 13.652344 C 13.103841 13.58724 12.972005 13.49935 12.861328 13.388672 C 12.75065 13.277995 12.66276 13.146159 12.597656 12.993164 C 12.532552 12.84017 12.5 12.675781 12.5 12.5 L 12.5 10 C 12.5 9.824219 12.532552 9.661459 12.597656 9.511719 C 12.66276 9.361979 12.752278 9.230144 12.866211 9.116211 C 12.980143 9.002279 13.111979 8.912761 13.261719 8.847656 C 13.411458 8.782553 13.574219 8.75 13.75 8.75 L 16.25 8.75 C 16.41927 8.75 16.580402 8.782553 16.733398 8.847656 C 16.886393 8.912761 17.019855 9.002279 17.133789 9.116211 C 17.247721 9.230144 17.337238 9.363607 17.402344 9.516602 C 17.467447 9.669597 17.5 9.830729 17.5 10 L 17.5 12.5 C 17.5 12.675781 17.467447 12.838542 17.402344 12.988281 C 17.337238 13.138021 17.247721 13.269857 17.133789 13.383789 C 17.019855 13.497722 16.88802 13.58724 16.738281 13.652344 C 16.588541 13.717448 16.425781 13.75 16.25 13.75 Z M 13.75 10 L 13.75 12.5 L 16.25 12.5 L 16.25 10 Z M 3.125 12.5 C 2.955729 12.5 2.809245 12.438151 2.685547 12.314453 C 2.561849 12.190756 2.5 12.044271 2.5 11.875 C 2.5 11.705729 2.561849 11.559245 2.685547 11.435547 C 2.809245 11.31185 2.955729 11.25 3.125 11.25 L 4.375 11.25 C 4.544271 11.25 4.690755 11.31185 4.814453 11.435547 C 4.938151 11.559245 5 11.705729 5 11.875 C 5 12.044271 4.938151 12.190756 4.814453 12.314453 C 4.690755 12.438151 4.544271 12.5 4.375 12.5 Z M 9.375 12.5 C 9.205729 12.5 9.059244 12.438151 8.935547 12.314453 C 8.811849 12.190756 8.75 12.044271 8.75 11.875 C 8.75 11.705729 8.811849 11.559245 8.935547 11.435547 C 9.059244 11.31185 9.205729 11.25 9.375 11.25 L 10.625 11.25 C 10.794271 11.25 10.940755 11.31185 11.064453 11.435547 C 11.18815 11.559245 11.25 11.705729 11.25 11.875 C 11.25 12.044271 11.18815 12.190756 11.064453 12.314453 C 10.940755 12.438151 10.794271 12.5 10.625 12.5 Z " />
                    </Button>
                    <Button Style="{StaticResource TransparentButtonStyle}">
                        <Button.Flyout>
                            <Flyout x:Name="ProfileFlyout" Placement="Bottom">
                                <Grid ColumnSpacing="12" RowSpacing="12">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>

                                    <PersonPicture
                                        Width="64"
                                        DisplayName="{x:Bind ViewModel.CurrentProfile.DisplayName, Mode=OneWay}"
                                        ProfilePicture="{x:Bind ViewModel.ProfileImageUrl, Mode=OneWay, Converter={StaticResource ProfileImageConverter}}" />

                                    <TextBlock Grid.Column="1" VerticalAlignment="Center">
                                        <Run Text="{x:Bind ViewModel.TitleText, Mode=OneWay}" /><LineBreak />
                                        <Run
                                            FontSize="13"
                                            Foreground="{ThemeResource DetailForegroundBrush}"
                                            Text="{x:Bind ViewModel.HeaderText, Mode=OneWay}" />
                                    </TextBlock>

                                    <Button
                                        Grid.Row="1"
                                        Grid.ColumnSpan="2"
                                        HorizontalAlignment="Stretch"
                                        Click="ProfileMenuClicked">
                                        <StackPanel Orientation="Horizontal" Spacing="6">
                                            <PathIcon
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Data="F1 M 4.921875 18.75 C 4.433594 18.75 3.966471 18.650717 3.520508 18.452148 C 3.074544 18.25358 2.683919 17.986654 2.348633 17.651367 C 2.013346 17.31608 1.746419 16.925455 1.547852 16.479492 C 1.349284 16.033529 1.25 15.566406 1.25 15.078125 L 1.25 4.921875 C 1.25 4.433594 1.349284 3.966473 1.547852 3.520508 C 1.746419 3.074545 2.013346 2.68392 2.348633 2.348633 C 2.683919 2.013348 3.074544 1.74642 3.520508 1.547852 C 3.966471 1.349285 4.433594 1.25 4.921875 1.25 L 15.078125 1.25 C 15.566406 1.25 16.033527 1.349285 16.479492 1.547852 C 16.925455 1.74642 17.31608 2.013348 17.651367 2.348633 C 17.986652 2.68392 18.25358 3.074545 18.452148 3.520508 C 18.650715 3.966473 18.75 4.433594 18.75 4.921875 L 18.75 15.078125 C 18.75 15.566406 18.650715 16.033529 18.452148 16.479492 C 18.25358 16.925455 17.986652 17.31608 17.651367 17.651367 C 17.31608 17.986654 16.925455 18.25358 16.479492 18.452148 C 16.033527 18.650717 15.566406 18.75 15.078125 18.75 Z M 15.048828 17.5 C 15.374349 17.5 15.685221 17.433268 15.981445 17.299805 C 16.277668 17.166342 16.538086 16.987305 16.762695 16.762695 C 16.987305 16.538086 17.16634 16.27767 17.299805 15.981445 C 17.433268 15.685222 17.5 15.37435 17.5 15.048828 L 17.5 4.951172 C 17.5 4.625651 17.433268 4.314779 17.299805 4.018555 C 17.16634 3.722332 16.987305 3.461914 16.762695 3.237305 C 16.538086 3.012695 16.277668 2.83366 15.981445 2.700195 C 15.685221 2.566732 15.374349 2.5 15.048828 2.5 L 4.951172 2.5 C 4.625651 2.5 4.314778 2.566732 4.018555 2.700195 C 3.722331 2.83366 3.461914 3.012695 3.237305 3.237305 C 3.012695 3.461914 2.833659 3.722332 2.700195 4.018555 C 2.566732 4.314779 2.5 4.625651 2.5 4.951172 L 2.5 15.048828 C 2.5 15.37435 2.566732 15.685222 2.700195 15.981445 C 2.833659 16.27767 3.012695 16.538086 3.237305 16.762695 C 3.461914 16.987305 3.722331 17.166342 4.018555 17.299805 C 4.314778 17.433268 4.625651 17.5 4.951172 17.5 Z M 7.5 7.451172 C 7.5 7.112631 7.568359 6.795248 7.705078 6.499023 C 7.841796 6.202801 8.024088 5.944012 8.251953 5.722656 C 8.479817 5.501303 8.745117 5.325521 9.047852 5.195312 C 9.350586 5.065105 9.667969 5.000001 10 5 C 10.338541 5.000001 10.660807 5.066732 10.966797 5.200195 C 11.272786 5.333659 11.538086 5.512695 11.762695 5.737305 C 11.987304 5.961914 12.16634 6.227214 12.299805 6.533203 C 12.433268 6.839193 12.5 7.161459 12.5 7.5 C 12.5 7.845053 12.433268 8.168945 12.299805 8.47168 C 12.16634 8.774414 11.987304 9.038086 11.762695 9.262695 C 11.538086 9.487305 11.272786 9.666342 10.966797 9.799805 C 10.660807 9.933269 10.338541 10 10 10 C 9.648438 10 9.319661 9.933269 9.013672 9.799805 C 8.707682 9.666342 8.442383 9.48405 8.217773 9.25293 C 7.993164 9.021811 7.817382 8.751628 7.69043 8.442383 C 7.563476 8.133139 7.5 7.802734 7.5 7.451172 Z M 11.25 7.5 C 11.25 7.330729 11.217447 7.169597 11.152344 7.016602 C 11.087239 6.863607 10.997721 6.730145 10.883789 6.616211 C 10.769856 6.502279 10.636393 6.412761 10.483398 6.347656 C 10.330403 6.282553 10.169271 6.25 10 6.25 C 9.824219 6.25 9.661458 6.282553 9.511719 6.347656 C 9.361979 6.412761 9.230143 6.502279 9.116211 6.616211 C 9.002278 6.730145 8.91276 6.86198 8.847656 7.011719 C 8.782552 7.161459 8.75 7.324219 8.75 7.5 C 8.75 7.675781 8.782552 7.84017 8.847656 7.993164 C 8.91276 8.146159 9.00065 8.277995 9.111328 8.388672 C 9.222005 8.49935 9.353841 8.58724 9.506836 8.652344 C 9.65983 8.717448 9.824219 8.75 10 8.75 C 10.175781 8.75 10.338541 8.717448 10.488281 8.652344 C 10.638021 8.58724 10.769856 8.497722 10.883789 8.383789 C 10.997721 8.269857 11.087239 8.138021 11.152344 7.988281 C 11.217447 7.838542 11.25 7.675781 11.25 7.5 Z M 5.488281 12.880859 C 5.488281 12.639975 5.530599 12.41862 5.615234 12.216797 C 5.69987 12.014975 5.81543 11.842448 5.961914 11.699219 C 6.108398 11.55599 6.282552 11.445312 6.484375 11.367188 C 6.686198 11.289062 6.907552 11.25 7.148438 11.25 L 12.851562 11.25 C 13.092447 11.25 13.313801 11.289062 13.515625 11.367188 C 13.717447 11.445312 13.891602 11.55599 14.038086 11.699219 C 14.18457 11.842448 14.30013 12.014975 14.384766 12.216797 C 14.4694 12.41862 14.511719 12.639975 14.511719 12.880859 C 14.511719 13.525391 14.379883 14.0625 14.116211 14.492188 C 13.852539 14.921875 13.505859 15.266928 13.076172 15.527344 C 12.646484 15.787761 12.163086 15.973308 11.625977 16.083984 C 11.088867 16.194662 10.546875 16.25 10 16.25 C 9.453125 16.25 8.911133 16.194662 8.374023 16.083984 C 7.836914 15.973308 7.353516 15.787761 6.923828 15.527344 C 6.494141 15.266928 6.147461 14.921875 5.883789 14.492188 C 5.620117 14.0625 5.488281 13.525391 5.488281 12.880859 Z M 13.261719 12.832031 C 13.261719 12.701823 13.221028 12.613933 13.139648 12.568359 C 13.058268 12.522787 12.962239 12.5 12.851562 12.5 L 7.148438 12.5 C 7.03776 12.5 6.941731 12.522787 6.860352 12.568359 C 6.778971 12.613933 6.738281 12.701823 6.738281 12.832031 C 6.738281 13.294271 6.839192 13.666992 7.041016 13.950195 C 7.242838 14.233398 7.501627 14.453125 7.817383 14.609375 C 8.133138 14.765625 8.483072 14.869792 8.867188 14.921875 C 9.251302 14.973959 9.628906 15 10 15 C 10.371094 15 10.748697 14.973959 11.132812 14.921875 C 11.516927 14.869792 11.866861 14.765625 12.182617 14.609375 C 12.498371 14.453125 12.75716 14.233398 12.958984 13.950195 C 13.160807 13.666992 13.261719 13.294271 13.261719 12.832031 Z " />

                                            <TextBlock Text="Edit Profile" />
                                        </StackPanel>
                                    </Button>

                                    <!--<Button
                                        Grid.Row="2"
                                        Grid.ColumnSpan="2"
                                        HorizontalAlignment="Stretch"
                                        Command="{x:Bind ViewModel.LogoutCommand}">
                                        <StackPanel Orientation="Horizontal" Spacing="6">
                                            <PathIcon
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Data="F1 M 1.25 16.787109 L 1.25 3.212891 C 1.25 3.056641 1.298828 2.921551 1.396484 2.807617 C 1.494141 2.693686 1.621094 2.623699 1.777344 2.597656 L 10.527344 1.259766 C 10.553385 1.253256 10.589192 1.25 10.634766 1.25 C 10.810547 1.25 10.957031 1.310223 11.074219 1.430664 C 11.191406 1.551107 11.25 1.699219 11.25 1.875 L 11.25 8.75 L 17.714844 8.75 L 16.464844 7.65625 C 16.321613 7.532553 16.25 7.376303 16.25 7.1875 C 16.25 7.01823 16.311848 6.871746 16.435547 6.748047 C 16.559244 6.62435 16.705729 6.5625 16.875 6.5625 C 17.03125 6.5625 17.171223 6.614584 17.294922 6.71875 L 19.785156 8.90625 C 19.928385 9.036459 20 9.192709 20 9.375 C 20 9.563803 19.928385 9.720053 19.785156 9.84375 L 17.294922 12.03125 C 17.171223 12.135417 17.03125 12.1875 16.875 12.1875 C 16.705729 12.1875 16.559244 12.125651 16.435547 12.001953 C 16.311848 11.878256 16.25 11.731771 16.25 11.5625 C 16.25 11.380209 16.321613 11.223959 16.464844 11.09375 L 17.714844 10 L 11.25 10 L 11.25 18.125 C 11.25 18.294271 11.193033 18.440756 11.079102 18.564453 C 10.965169 18.68815 10.820312 18.75 10.644531 18.75 C 10.592447 18.75 10.553385 18.746744 10.527344 18.740234 L 1.777344 17.402344 C 1.621094 17.376303 1.494141 17.306314 1.396484 17.192383 C 1.298828 17.078451 1.25 16.943359 1.25 16.787109 Z M 12.5 7.5 L 12.5 2.5 L 13.125 2.5 C 13.294271 2.5 13.440755 2.56185 13.564453 2.685547 C 13.68815 2.809246 13.75 2.95573 13.75 3.125 L 13.75 7.5 Z M 2.5 16.25 L 10 17.402344 L 10 2.607422 L 2.5 3.75 Z M 7.1875 10.625 C 7.1875 10.364584 7.278646 10.143229 7.460938 9.960938 C 7.643229 9.778646 7.864583 9.6875 8.125 9.6875 C 8.385416 9.6875 8.606771 9.778646 8.789062 9.960938 C 8.971354 10.143229 9.0625 10.364584 9.0625 10.625 C 9.0625 10.885417 8.971354 11.106771 8.789062 11.289062 C 8.606771 11.471354 8.385416 11.5625 8.125 11.5625 C 7.864583 11.5625 7.643229 11.471354 7.460938 11.289062 C 7.278646 11.106771 7.1875 10.885417 7.1875 10.625 Z M 12.5 17.5 L 12.5 11.25 L 13.75 11.25 L 13.75 16.875 C 13.75 17.044271 13.68815 17.190756 13.564453 17.314453 C 13.440755 17.43815 13.294271 17.5 13.125 17.5 Z " />
                                            <TextBlock Text="Sign Out" />
                                        </StackPanel>
                                    </Button>-->
                                </Grid>
                            </Flyout>
                        </Button.Flyout>
                        <PersonPicture
                            Width="32"
                            DisplayName="{x:Bind ViewModel.CurrentProfile.DisplayName, Mode=OneWay}"
                            ProfilePicture="{x:Bind ViewModel.ProfileImageUrl, Mode=OneWay, Converter={StaticResource ProfileImageConverter}}" />
                    </Button>
                </StackPanel>
            </TitleBar.Footer>
        </TitleBar>

        <controls1:CustomNavigationView
            x:Name="MainNavigationView"
            Grid.Row="1"
            Background="{ThemeResource ContentBackgroundBrush}"
            IsBackButtonVisible="Collapsed"
            IsPaneToggleButtonVisible="False"
            IsTitleBarAutoPaddingEnabled="True"
            OpenPaneLength="{x:Bind ViewModel.PreferencesService.ShellMenuPageOpenWidth, Mode=TwoWay}"
            SelectedIndex="{x:Bind ViewModel.SelectedMenuItemIndex, Mode=TwoWay}"
            SelectionChanged="NavigationSelectionChanged">
            <NavigationView.MenuItems>
                <NavigationViewItem Content="Broadcast">
                    <NavigationViewItem.Tag>
                        <navigation:PageType>BroadcastPage</navigation:PageType>
                    </NavigationViewItem.Tag>
                    <NavigationViewItem.Icon>
                        <FontIcon FontFamily="{StaticResource OpenEmailIconFontFamily}" Glyph="{x:Bind main:OpenEmailIcons.Broadcast}" />
                    </NavigationViewItem.Icon>
                </NavigationViewItem>

                <NavigationViewItem Content="Inbox">
                    <NavigationViewItem.Tag>
                        <navigation:PageType>MailInbox</navigation:PageType>
                    </NavigationViewItem.Tag>
                    <NavigationViewItem.Icon>
                        <FontIcon FontFamily="{StaticResource OpenEmailIconFontFamily}" Glyph="{x:Bind main:OpenEmailIcons.Inbox}" />
                    </NavigationViewItem.Icon>
                </NavigationViewItem>

                <NavigationViewItem Content="Outbox">
                    <NavigationViewItem.Tag>
                        <navigation:PageType>MailOutbox</navigation:PageType>
                    </NavigationViewItem.Tag>
                    <NavigationViewItem.Icon>
                        <FontIcon FontFamily="{StaticResource OpenEmailIconFontFamily}" Glyph="{x:Bind main:OpenEmailIcons.Outbox}" />
                    </NavigationViewItem.Icon>
                </NavigationViewItem>

                <NavigationViewItem Content="Drafts">
                    <NavigationViewItem.Tag>
                        <navigation:PageType>MailDrafts</navigation:PageType>
                    </NavigationViewItem.Tag>
                    <NavigationViewItem.Icon>
                        <FontIcon FontFamily="{StaticResource OpenEmailIconFontFamily}" Glyph="{x:Bind main:OpenEmailIcons.Drafts}" />
                    </NavigationViewItem.Icon>
                </NavigationViewItem>

                <NavigationViewItem Content="Trash">
                    <NavigationViewItem.Tag>
                        <navigation:PageType>MailTrash</navigation:PageType>
                    </NavigationViewItem.Tag>
                    <NavigationViewItem.Icon>
                        <FontIcon FontFamily="{StaticResource OpenEmailIconFontFamily}" Glyph="{x:Bind main:OpenEmailIcons.Trash}" />
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
            </NavigationView.MenuItems>

            <NavigationView.FooterMenuItems>
                <NavigationViewItem Content="Contacts">
                    <NavigationViewItem.Tag>
                        <navigation:PageType>ContactsPage</navigation:PageType>
                    </NavigationViewItem.Tag>
                    <NavigationViewItem.Icon>
                        <FontIcon FontFamily="{StaticResource OpenEmailIconFontFamily}" Glyph="{x:Bind main:OpenEmailIcons.Contacts}" />
                    </NavigationViewItem.Icon>
                    <NavigationViewItem.InfoBadge>
                        <InfoBadge Visibility="{x:Bind ViewModel.HasPendingContactRequests, Mode=OneWay}" Value="{x:Bind ViewModel.PendingContactRequestCount, Mode=OneWay}" />
                    </NavigationViewItem.InfoBadge>
                </NavigationViewItem>
            </NavigationView.FooterMenuItems>

            <!--  Navigation content  -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="1" />
                    <ColumnDefinition Width="*" />

                </Grid.ColumnDefinitions>

                <!--  Note the use of a TwoWay binding here, this is required for this control to work.  -->
                <controls:PropertySizer
                    HorizontalAlignment="Left"
                    Binding="{x:Bind MainNavigationView.OpenPaneLength, Mode=TwoWay}"
                    Maximum="440"
                    Minimum="140"
                    Visibility="{x:Bind MainNavigationView.IsPaneOpen, Mode=OneWay}" />

                <!--  Nav Frame  -->
                <Frame
                    x:Name="LeftFrame"
                    Grid.Column="1"
                    BorderThickness="0.5,0.5,0,0"
                    CornerRadius="8,0,0,0">
                    <Frame.Transitions>
                        <TransitionCollection>
                            <PopupThemeTransition />
                        </TransitionCollection>
                    </Frame.Transitions>
                </Frame>

                <!--  Profile display side menu  -->
                <controls1:ContactProfileControl
                    Grid.Column="1"
                    Width="400"
                    HorizontalAlignment="Right"
                    ui:Effects.Shadow="{StaticResource CommonShadow}"
                    Background="{ThemeResource ContentBackgroundBrush}"
                    BroadcastStateChangedCommand="{x:Bind ViewModel.BroadcastStateChangedCommand}"
                    ClosePaneCommand="{x:Bind ViewModel.CloseProfileInformationCommand}"
                    Contact="{x:Bind ViewModel.DisplayingContactInformation, Mode=OneWay}"
                    IsClosePaneButtonVisible="True"
                    Visibility="{x:Bind ViewModel.IsProfileLoadMenuVisible, Mode=OneWay}">
                    <animations:Implicit.ShowAnimations>
                        <animations:TranslationAnimation
                            From="300,0,0"
                            To="0"
                            Duration="0:0:0.5" />
                        <animations:OpacityAnimation
                            From="0"
                            To="1.0"
                            Duration="0:0:0.5" />
                    </animations:Implicit.ShowAnimations>
                </controls1:ContactProfileControl>

                <!--  Info bar message  -->
                <InfoBar
                    x:Name="InfoBarMessage"
                    Grid.Column="1"
                    Grid.ColumnSpan="3"
                    MaxWidth="600"
                    Margin="25"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Bottom"
                    IsClosable="False" />
            </Grid>
        </controls1:CustomNavigationView>

        <tb:TaskbarIcon
            x:Name="TrayIcon"
            x:FieldModifier="public"
            ContextMenuMode="SecondWindow"
            DoubleClickCommand="{x:Bind ViewModel.DoubleClickedCommand}"
            IconSource="/Assets/appicon.ico"
            NoLeftClickDelay="True"
            ToolTipText="Open Email">
            <tb:TaskbarIcon.ContextFlyout>
                <MenuFlyout AreOpenCloseAnimationsEnabled="False">
                    <MenuFlyoutItem Click="LaunchClicked" Text="Launch" />
                    <MenuFlyoutSeparator />
                    <MenuFlyoutItem Click="ExitClicked" Text="Exit" />
                </MenuFlyout>
            </tb:TaskbarIcon.ContextFlyout>
        </tb:TaskbarIcon>

        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="AdaptiveStates">
                <VisualState x:Name="Narrow">
                    <VisualState.Setters>
                        <Setter Target="NewMessageTextBlock.Visibility" Value="Collapsed" />
                        <Setter Target="NextSynchronizationTextBlock.Visibility" Value="Collapsed" />
                        <Setter Target="NewMessageButton.Width" Value="100" />
                        <Setter Target="SynchronizeButton.Width" Value="60" />
                    </VisualState.Setters>
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="0" />
                    </VisualState.StateTriggers>
                </VisualState>
                <VisualState x:Name="Wide">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="800" />
                    </VisualState.StateTriggers>
                </VisualState>
            </VisualStateGroup>

            <VisualStateGroup x:Name="ContactProfilePaneStates">

                <VisualState x:Name="PaneInactive" />
                <VisualState x:Name="PaneActive">
                    <VisualState.StateTriggers>
                        <StateTrigger IsActive="{x:Bind IsDisplayingProfileControl, Mode=OneWay}" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="LeftFrame.Margin" Value="0,0,400,0" />
                    </VisualState.Setters>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
    </Grid>
</local:ShellPageAbstract>
